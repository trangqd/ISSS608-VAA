{
  "hash": "b6cba911c36acb929792c70041a8fe9c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1 (Part 1)\"\ndate: \"May 1, 2025\"\ndate-modified: \"last-modified\"\nformat:\n  html:\n    theme: cosmo\n    toc: true\neditor: visual\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n# Overview\n\nThis study provides a comprehensive demographic analysis of Singapore, leveraging multiple visualizations to uncover patterns in population distribution, age structure, dependency ratios, and gender balance across regions and planning areas. The first section presents a suite of five integrated charts that offer both macro and micro perspectives on population distribution—highlighting regional totals, intra-regional variability, the number of administrative units, and the concentration of population within selected planning areas. The second section examines the population structure by age group across regions and quantifies the dependency ratio at the planning area level, which reflects the economic pressure placed on the working-age population by younger and older dependents. The third section investigates the variation in sex ratios across planning areas, identifying gender imbalances and regional trends. \n\nDataset used: [Singapore Residents by Planning Area / Subzone, Single Year of Age and Sex, June 2024](https://www.singstat.gov.sg/-/media/files/find_data/population/statistical_tables/respopagesextod2024.ashx) \n\n# Preparation\n\n## Install packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork, \n               ggthemes, hrbrthemes,\n               tidyverse, tidytext, scales) \n```\n:::\n\n\n## Import data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read_csv(\"respopagesex2024.csv\")\n```\n:::\n\n\n# Data Wrangling\n\n## Data Discovery and Cleaning\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Summary statistics\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      PA                 SZ                Age                Sex           \n Length:60424       Length:60424       Length:60424       Length:60424      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n      Pop              Time     \n Min.   :   0.0   Min.   :2024  \n 1st Qu.:   0.0   1st Qu.:2024  \n Median :  20.0   Median :2024  \n Mean   :  69.4   Mean   :2024  \n 3rd Qu.:  90.0   3rd Qu.:2024  \n Max.   :1180.0   Max.   :2024  \n```\n\n\n:::\n\n```{.r .cell-code}\n# Count of missing values per column\ncolSums(is.na(data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  PA   SZ  Age  Sex  Pop Time \n   0    0    0    0    0    0 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Count of duplicated rows\nsum(duplicated(data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n\n```{.r .cell-code}\n# View duplicated rows (if any)\ndata[duplicated(data), ]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 0 × 6\n# ℹ 6 variables: PA <chr>, SZ <chr>, Age <chr>, Sex <chr>, Pop <dbl>,\n#   Time <dbl>\n```\n\n\n:::\n:::\n\n\n**Summary interpretation:**\n\n1.  Total observations: **60,424 rows. No missing values and duplicates** were found.\n2.  Current data types: PA, SZ, Age, Sex, Time are character. Pop and Time are numeric.\n3.  Issues to be fixed:\n\n-   **The \"Age\" column is currently of type character** due to the presence of the value \"90 and Over\". To convert the column to numeric, this value is transformed into a numeric-compatible format. I replace this with \"90\" to ensure consistent analysis without assuming more than what the data provides.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check unique values of Age column \nunique(data$Age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"0\"           \"1\"           \"2\"           \"3\"           \"4\"          \n [6] \"5\"           \"6\"           \"7\"           \"8\"           \"9\"          \n[11] \"10\"          \"11\"          \"12\"          \"13\"          \"14\"         \n[16] \"15\"          \"16\"          \"17\"          \"18\"          \"19\"         \n[21] \"20\"          \"21\"          \"22\"          \"23\"          \"24\"         \n[26] \"25\"          \"26\"          \"27\"          \"28\"          \"29\"         \n[31] \"30\"          \"31\"          \"32\"          \"33\"          \"34\"         \n[36] \"35\"          \"36\"          \"37\"          \"38\"          \"39\"         \n[41] \"40\"          \"41\"          \"42\"          \"43\"          \"44\"         \n[46] \"45\"          \"46\"          \"47\"          \"48\"          \"49\"         \n[51] \"50\"          \"51\"          \"52\"          \"53\"          \"54\"         \n[56] \"55\"          \"56\"          \"57\"          \"58\"          \"59\"         \n[61] \"60\"          \"61\"          \"62\"          \"63\"          \"64\"         \n[66] \"65\"          \"66\"          \"67\"          \"68\"          \"69\"         \n[71] \"70\"          \"71\"          \"72\"          \"73\"          \"74\"         \n[76] \"75\"          \"76\"          \"77\"          \"78\"          \"79\"         \n[81] \"80\"          \"81\"          \"82\"          \"83\"          \"84\"         \n[86] \"85\"          \"86\"          \"87\"          \"88\"          \"89\"         \n[91] \"90_and_Over\"\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert Age to numeric\ndata <- data %>%\n  mutate(Age = if_else(Age == \"90_and_Over\", \"90\", Age)) %>%  # Replace string with number\n  mutate(Age = as.numeric(Age))  # Convert to numeric\n\n# Check the new data type\nclass(data$Age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"numeric\"\n```\n\n\n:::\n:::\n\n\n-   **Change column names for \"PA\", \"SZ\", and \"Pop\"** to enhance clarity and readability.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rename columns\ndata <- data %>%\n  rename(\n    Planning_Area = PA,\n    Sub_Zone = SZ,\n    Population = Pop\n  )\n```\n:::\n\n\n-   **Remove unnecessary column \"Time\"** since all values are 2024 - the year in which the data was collected.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>% select(-Time)\n```\n:::\n\n\n-   **Remove planning areas with 0 population** since they don’t contribute any demographic information (no age, sex data to analyze). These areas might be undeveloped, industrial, or restricted areas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>%\n  filter(Population > 0)\n\ndata %>%\n  group_by(Planning_Area) %>%\n  summarise(Total_Pop = sum(Population)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 42 × 2\n   Planning_Area Total_Pop\n   <chr>             <dbl>\n 1 Ang Mo Kio       160450\n 2 Bedok            277660\n 3 Bishan            88210\n 4 Bukit Batok      168390\n 5 Bukit Merah      149390\n 6 Bukit Panjang    138730\n 7 Bukit Timah       84250\n 8 Changi             1830\n 9 Choa Chu Kang    190640\n10 Clementi         102960\n# ℹ 32 more rows\n```\n\n\n:::\n:::\n\n\nAfter removal, 42 planning areas remain in the dataset.\n\n-   **Final review after cleaning**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Planning_Area        Sub_Zone              Age            Sex           \n Length:37243       Length:37243       Min.   : 0.00   Length:37243      \n Class :character   Class :character   1st Qu.:22.00   Class :character  \n Mode  :character   Mode  :character   Median :44.00   Mode  :character  \n                                       Mean   :44.32                     \n                                       3rd Qu.:66.00                     \n                                       Max.   :90.00                     \n   Population    \n Min.   :  10.0  \n 1st Qu.:  30.0  \n Median :  70.0  \n Mean   : 112.6  \n 3rd Qu.: 150.0  \n Max.   :1180.0  \n```\n\n\n:::\n\n```{.r .cell-code}\ncolSums(is.na(data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPlanning_Area      Sub_Zone           Age           Sex    Population \n            0             0             0             0             0 \n```\n\n\n:::\n:::\n\n\n## Feature Engineering\n\n1.  **Create Age Groups**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    Age_Group = cut(\n      Age,\n      breaks = c(-1, 14, 64, Inf),\n      labels = c(\"0-14\", \"15-64\", \"65+\"),\n      right = TRUE\n    )\n  )\n```\n:::\n\n\nThe age groups were defined as 0–14, 15–64, and 65+ to align with the standard demographic classification used in population studies and official statistics. These ranges correspond to:\n\n-   0–14: Young dependents (not in the workforce).\n\n-   15–64: Working-age population (economically active group).\n\n-   65+: Elderly dependents (retired).\n\n2.  **Create Regions** \n\nThe Region column is created to group planning areas into broader zones, enabling regional-level analysis, comparison, and visualization. I referred to [this website](https://en.wikipedia.org/wiki/Planning_areas_of_Singapore) for the regions and planning areas mapping.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Region mapping table\nregion_mapping <- tibble::tibble(\n  Planning_Area = c(\n    # Central\n    \"Bishan\", \"Bukit Merah\", \"Bukit Timah\", \"Downtown Core\", \"Geylang\", \"Kallang\",\n    \"Marine Parade\", \"Museum\", \"Newton\", \"Novena\", \"Orchard\", \"Outram\",\n    \"Queenstown\", \"River Valley\", \"Rochor\", \"Singapore River\", \"Southern Islands\",\n    \"Tanglin\", \"Toa Payoh\",\n\n    # East\n    \"Bedok\", \"Changi\", \"Pasir Ris\", \"Tampines\",\n\n    # North-East\n    \"Ang Mo Kio\", \"Hougang\", \"Punggol\", \"Sengkang\", \"Serangoon\", \"Seletar\",\n\n    # North\n    \"Mandai\", \"Sembawang\", \"Sungei Kadut\", \"Woodlands\", \"Yishun\",\n\n    # West\n    \"Bukit Batok\", \"Bukit Panjang\", \"Choa Chu Kang\", \"Clementi\", \"Jurong East\",\n    \"Jurong West\", \"Tengah\", \"Western Water Catchment\"\n  ),\n  Region = c(\n    rep(\"Central\", 19),\n    rep(\"East\", 4),\n    rep(\"North-East\", 6),\n    rep(\"North\", 5),\n    rep(\"West\", 8)\n  )\n)\n\n\n# Join with data\ndata <- data %>%\n  left_join(region_mapping, by = \"Planning_Area\")\n```\n:::\n\n\n# Data Visualization\n\n## 1. Singapore's Population Distribution and Density\n\nThis full visualization provides a multi-layered view of Singapore's population landscape, highlighting regional totals, planning area distributions, administrative granularity, and Pareto-based breakdowns of population concentration.\n\nThe process of creating this visualization is as below:\n\n1.  **Step 1: Creating 4 individual plots**\n\n-   **Plot 1: Total population by Region**\n\n    -   Data is grouped by `Region` to get total population per region.\n\n    -   The regions are sorted in descending order of population.\n\n    -   A **horizontal bar chart** is created using `geom_col()`. Labels showing total population are added with `geom_text()` using comma formatting. The chart is flipped horizontally using `coord_flip()`. `Set2` color palette is used for a visually distinct fill and label color per region. The plot uses `theme_clean()` and custom font styling for clarity.\n\n-   **Plot 2: Distribution of Planning Areas' population by Region**\n\n    -   Total population is aggregated at the Planning Area level, grouped by Region.\n\n    -   A **boxplot** is drawn with `geom_boxplot()` to show the distribution of planning area populations within each region.\n\n    -   Outliers are highlighted in tomato red, and median values are labeled using `stat_summary()` for easier interpretation.\n\n-   **Plot 3: Count of Planning Areas and Sub-Zones by Region**\n\n    -   `n_distinct()` is used to count the number of unique planning areas and sub-zones in each region.\n\n    -   The data is then reshaped to a long format using `pivot_longer()` for grouped plotting\n\n    -   A **grouped bar chart** is created using `geom_col()` to compare the count of Planning Areas & Sub-Zones among Regions.\n\n    -   Labels show exact counts above each bar, with the same color as the bar type.\n\n-   **Plot 4: Regional Population Breakdown by Planning Area**\n\n    -   For each Region, planning areas are ranked by population.\n\n    -   Then, cumulative population and cumulative percentage for the Pareto curve.\n\n    -   A scale factor is computed to align the cumulative percentage line on the same y-axis.\n\n    -   A **Pareto chart** is created with:\n\n        -   Bars representing population by planning area.\n\n        -   Line and points representing cumulative % scaled to dual y-axis.\n\n        -   Facets by Region for side-by-side comparisons.\n\n        -   Top planning area in each non-Central region is labeled.\n\n2.  **Step 2: Combining all plots**\n\n    The four plots are **combined** into one cohesive layout using `patchwork`:\n\n    -   Top: Bar chart (Plot 1)\n\n    -   Middle: Boxplot and grouped bar chart side-by-side (Plots 2 and 3)\n\n    -   Bottom: Faceted Pareto chart (Plot 4)\n\n    -   Relative heights = c(0.6, 0.6, 1.8) using `plot_layout()`are adjusted to give the Pareto chart more visual space.\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-12-1.png){width=1536}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)\n# Aggregate population by region, planning area, and sub-zone\npop <- data %>%\n  group_by(Region, Planning_Area, Sub_Zone) %>%\n  summarise(total_pop = sum(Population), .groups=\"drop\")\n\n# (Plot 1) Total population by Region\nregion_pop <- pop %>%\n  group_by(Region) %>%\n  summarise(total_pop = sum(total_pop), .groups=\"drop\") %>%\n  arrange(desc(total_pop))\n\n# Create horizontal bar chart\np1 <- ggplot(region_pop, aes(x = reorder(Region, total_pop), y = total_pop, fill = Region)) +\n  geom_col() +\n  geom_text(aes(label = comma(total_pop), color = Region), \n            hjust = -0.1, size = 4, fontface = \"bold\") +\n  coord_flip() #flip to horizontal +\n  scale_y_continuous(labels = comma, expand = expansion(mult = c(0, 0.1))) +\n  labs(title = \"Total Population by Region\", x = \"Region\", y = \"Total Population\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  scale_color_brewer(palette = \"Set2\") +\n  theme_clean() +\n  theme(plot.title = element_text(face = \"bold\"),\n        axis.title = element_text(face = \"bold\"),\n        axis.text  = element_text(face = \"italic\"),\n        legend.position = \"none\")\n\n# (Plot 2) Distribution of Planning‐Area Populations by Region\nbox_data <- pop %>%\n  group_by(Region, Planning_Area) %>%\n  summarise(total_pop = sum(total_pop), .groups = \"drop\")\n\np2 <- ggplot(box_data, aes(x = Region, y = total_pop, fill = Region, color = Region)) +\n  geom_boxplot(\n    width = 0.7,      # thickness of the boxes\n    alpha = 0.3,      # transparency of the boxes\n    outlier.shape = 16, outlier.size = 1.5, outlier.colour=\"tomato\"\n  ) +\n  \n  # add label for the median \n  stat_summary(\n    fun = median,\n    geom = \"text\",\n    aes(label = comma(..y..)),\n    color   = \"black\",\n    size    = 4,\n    vjust   = -0.5 \n  ) +\n  labs(\n    title = \"Planning Area Population Distribution by Region\",\n    x     = \"Region\",\n    y     = \"Planning Area Population\"\n  ) +\n  scale_y_continuous(labels = scales::comma) + \n  theme_clean() +\n  theme(\n    plot.title  = element_text(face = \"bold\"),\n    axis.text   = element_text(face = \"italic\"),\n    legend.position = \"none\"  \n  )\n\n# (Plot 3) Count of Planning Areas & Sub-Zones by Region\nregion_counts <- pop %>%\n  group_by(Region) %>%\n  summarise(\n    Planning_Areas = n_distinct(Planning_Area),\n    Subzones       = n_distinct(Sub_Zone),\n    .groups=\"drop\"\n  )\n\nregion_long <- region_counts %>%\n  pivot_longer(cols = c(Planning_Areas, Subzones),\n               names_to = \"Type\", values_to = \"Count\")\n\np3 <- ggplot(region_long, aes(x = Region, y = Count, fill = Type)) +\n  geom_col(position = \"dodge\") +\n  geom_text(aes(label = Count, color = Type),\n            position = position_dodge(width = 0.9),\n            vjust = -0.3, size = 4, fontface = \"bold\") +\n  labs(title = \"Number of Planning Areas and Subzones by Region\",\n       x = \"Region\", y = \"Count\") +\n  scale_fill_brewer(palette = \"Set2\", name = \"Type\") +\n  scale_color_brewer(palette = \"Set2\") +\n  theme_clean() +\n  theme(plot.title = element_text(face=\"bold\"),\n        axis.title = element_text(face=\"bold\"),\n        axis.text  = element_text(face=\"italic\"))\n\n# (Plot 4) Regional Population Breakdown by Planning Area\npareto_data <- pop %>%\n  group_by(Region, Planning_Area) %>%\n  summarise(total_pop = sum(total_pop), .groups = \"drop\") %>%\n  group_by(Region) %>%\n  arrange(desc(total_pop), .by_group = TRUE) %>%\n  mutate(\n    rank = row_number(),\n    cum_pop = cumsum(total_pop),\n    cum_pct = cum_pop / sum(total_pop),\n    label = comma(total_pop)\n  ) %>%\n  ungroup()\n\n# Scale factor for dual y-axis\nscale_fac <- max(pareto_data$total_pop)\n\n# Pareto chart with facets\np4 <- ggplot(pareto_data, aes(x = reorder(Planning_Area, -total_pop), y = total_pop)) +\n  geom_col(aes(fill = Region), show.legend = FALSE, alpha = 0.8) +\n  geom_line(aes(y = cum_pct * scale_fac, group = 1), color = \"red\", size = 1) +\n  geom_point(aes(y = cum_pct * scale_fac), color = \"red\", size = 2) +\n  geom_text(data = pareto_data %>% filter(rank == 1 & Region != \"Central\"),\n            aes(label = label), vjust = -0.5, size = 3, color = \"red\", fontface=\"bold\") +\n  scale_y_continuous(\n    name = \"Population\",\n    labels = comma,\n    breaks = seq(0, 350000, by = 50000),\n    sec.axis = sec_axis(~ . / scale_fac,\n                        name = \"Cumulative %\",\n                        labels = percent_format(accuracy = 1))\n  ) +\n  facet_wrap(~ Region, scales = \"free_x\") +\n  labs(\n    title = \"Regional Population Breakdown by Planning Area\",\n    x = \"Planning Area\", y = \"Population\"\n  ) +\n  theme_clean() +\n  theme(panel.spacing  = unit(1, \"cm\"),\n        axis.title = element_text(face=\"bold\"),\n        axis.text.x = element_text(angle = 45, hjust = 1))\n\n# Combine all the charts using patchwork\np1 / (p3 | p2) / p4 +\n  plot_layout(heights = c(0.6, 0.6, 1.8) )\n```\n:::\n\n:::\n\n::: {style=\"background-color: #fffbe7; padding: 2em; border-radius: 12px\"}\n### Key insights from the visualization:\n\n1.  **Urban Structure and Planning Complexity Differ Sharply Across Regions**\n\n    Although the Central region has a total population similar to the North-East (\\~973K) and West (\\~942K), it has significantly more planning areas (19) and sub-zones (111), indicating greater land use diversity and functional complexity. This contrasts with the East and North-East, where fewer planning areas serve large residential populations, indicating more concentrated residential zoning. These differences affect how urban policies, zoning regulations, and public services must be tailored to fit the region's functional layout.\n\n2.  **Population concentration varies by Region**\n\n    The boxplot and Pareto charts together show significant intra-regional variation: East and North have the widest spread, from very low to high planning area populations, while Central, North-East and East have more uniform residential distribution. For instance, Tampines and Bedok alone comprise nearly 60% of the East's total population.\n\n    This uneven load places infrastructure and service pressure on a few high-density zones, requiring targeted investments in transport, schools, and healthcare facilities. Meanwhile, lower-population areaspresent opportunities for future development or re-purposing.\n:::\n\n## 2. Demographic Pressure and Age Structure Across Singapore's Planning Areas\n\n\nThis chart aims to visualize the age composition across regions and assess the economic burden of dependents by comparing dependency ratios across planning areas in Singapore.\n\nThe process of creating this visualization is as below:\n\n1.  **Step 1:** **Data Preparation – Age Group Aggregation**\n\n-   The population data is grouped by Region, Planning Area, and Age Group.\n\n-   The three broad age categories (children: 0-14, working-age: 15-64 elderly: 65+) are explicitly ordered to ensure correct stacking in charts.\n\n2.  **Step 2: Creating 2 individual plots**\n\n-   **Plot 1:** **Population Structure by Region**\n\n    -   First, aggregate age-group data at the regional level, then computes the proportion of each age group relative to the region’s total population.\n\n    -   A stacked bar chart is then created using `geom_bar()`, with Region as x-axis, Proportion of each group as y-axis, and fill color based on age group.\n\n    -   Each bar segment is labeled with a percentage for clarity.\n\n    -   A custom theme (theme_gdocs) and Set2 color palette are used for visual appeal.\n\n-   **Plot 2: Dependency Ratio by Planning Area**\n\n    -   The dataset is reshaped from long to wide format to calculate dependency ratios:\n\n        -   Formula: (children + elderly) / working-age\n\n        -   A higher ratio means greater economic burden on the working population.\n\n    -   A dot plot is created using `geom_point` to show the dependency ratio by planning area, sorted in descending order.\n\n        -   Planning areas with the highest economic burden are shown at the top.\n\n        -   Titles and subtitle communicate economic implications of aging or youth-heavy populations.\n\n3.  **Combining 2 charts into 1 composite plot**\n\n-   The two plots are arranged side by side using the `patchwork` package.\n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-14-1.png){width=1728}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Aggregate population data by age group\n\npop_by_age <- data %>%\n  group_by(Region, Planning_Area, Age_Group) %>%\n  summarise(Population = sum(Population), .groups = \"drop\") %>%\n  mutate(Age_Group = factor(Age_Group, levels = c(\"0-14\", \"15-64\", \"65+\")))\n\n# Plot 1 - Population Structure by Region \n\n# Aggregate for regional proportion\nregion_age_prop <- pop_by_age %>%\n  group_by(Region, Age_Group) %>%\n  summarise(Population = sum(Population), .groups = \"drop\") %>%\n  group_by(Region) %>%\n  mutate(Proportion = Population / sum(Population))\n\np1 <- ggplot(region_age_prop, aes(\n  x = Region,\n  y = Proportion,\n  fill = Age_Group\n)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = scales::percent(Proportion, accuracy = 0.1)),\n            position = position_stack(vjust = 0.5),  # center within each segment\n            size = 6, color = \"white\") +\n  labs(\n    title = \"Population Structure by Region\",\n    x = \"Region\", y = \"Proportion\"\n  ) +\n  scale_y_continuous(labels = scales::percent) +\n  scale_fill_brewer(palette = \"Set2\") + \n  theme_gdocs() + \n  theme(plot.title = element_text(size = 18, face = \"bold\", color = \"blue\"), \n        axis.title = element_text(face = \"bold\", color = \"blue\"),\n        axis.text = element_text(size = 13, face = \"bold\"))\n\n\n# Plot 2 - Dependency Ratio by Planning Area\n\ndependency_df <- pop_by_age %>%\n  pivot_wider(names_from = Age_Group, values_from = Population, values_fill = 0) %>%\n  filter(`15-64` > 0) %>%\n  mutate(dependency_ratio = (`0-14` + `65+`) / `15-64`) %>%\n  arrange(desc(dependency_ratio))\n\np2 <- ggplot(dependency_df, aes(x = dependency_ratio, y = reorder(Planning_Area, dependency_ratio))) +\n  geom_point(color = \"tomato\", size = 3) +\n  labs(\n    title = \"Dependency Ratio by Planning Area\",\n    subtitle = \"Higher ratio = more economic pressure\",\n    x = \"Dependency Ratio\", y = \"Planning Area\"\n  ) + \n  theme_gdocs() +\n  theme(\n    plot.title = element_text(size= 18, face = \"bold\", color = \"blue\"),\n    plot.subtitle = element_text(size = 15, face = \"italic\", color = \"red\"),\n    axis.title = element_text(face = \"bold\", color=\"blue\"), \n    axis.text = element_text(face = \"bold\")) \n\n# Combine into a composite figure \n\n(p1 | p2) +\n  plot_annotation(tag_levels = \"I\")\n```\n:::\n\n:::\n\n::: {style=\"background-color: #fffbe7; padding: 2em; border-radius: 12px\"}\n### Key insights from the visualization:\n\n1.  **Age structure varies across regions**\n\n-   The working-age group (15–64) dominates across all regions but is highest in the North (71.3%), suggesting a strong labor base.\n\n-   The elderly population (65+) is most prominent in the Central region (21.6%), indicating an aging population and possibly a concentration of older, long-established residential areas. In contrast, the North-East and West have higher proportions of children (0–14), around 15%, suggesting younger family populations and possibly newer housing developments attractive to younger households.\n\n2.  **Dependency Ratios Vary Greatly by Planning Area**\n\n-   Outram has the highest dependency ratio (over 0.6), followed closely by Bukit Merah and Ang Mo Kio, indicating that there are more than 60 dependents for every 100 working-age individuals. This suggests greater economic pressure in these areas. In contrast, Seletar, Museum, and Downtown Core have very low dependency ratios (below 0.2), reflecting either a predominantly working-age population or limited residential presence.\n\n-   The Central region not only has the highest share of elderly but also includes multiple planning areas like Outram, Bukit Merah, and Marine Parade with very high dependency ratios. This combination implies that Central Singapore may face greater healthcare, caregiving, and aging-related infrastructure needs than other regions.\n:::\n\n## 3. Singapore's Sex Ratio by Planning Area\n\nThis chart visually compares the sex ratios across Singapore’s planning areas, helping to identify areas with gender imbalances that could have social, economic, or policy implications.\n\nThe process of creating this plot is as below:\n\n1.  Step 1: Data Preparation: Calculating Sex Ratio by Planning Area\n\n-   The dataset is grouped by Region and Planning Area.\n\n-   For each planning area, the total population is calculated.\n\n-   The sex ratio is computed as the number of males divided by the number of females.\n\n    -   A ratio \\> 1 means more males than females.\n\n    -   A ratio \\< 1 means more females than males.\n\n2.  **Step 2: Chart Construction: Lollipop Chart**\n\n-   The planning areas are reordered based on their sex ratios, so the chart visually compares areas from lowest to highest ratio.\n\n-   Points and segments are colored by Region to show regional grouping.\n\n-   Using `geom_segment()` , a horizontal line (stem) is drawn from a baseline of `1` (equal male-female ratio) to each area's actual sex ratio. A dot (head) is placed at the actual sex ratio value to complete the lollipop visual.\n\n-   Finally, the plot is flipped horizontally using `coord_flip()` , placing planning areas on the y-axis for easier label readability.\n\n\n:::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-16-1.png){width=576}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Compute sex ratio per Planning Area\nlollipop_feats <- data %>%\n  group_by(Region, Planning_Area) %>%\n  summarise(\n    total_pop  = sum(Population),\n    sex_ratio  = sum(Population[Sex == \"Males\"]) /\n                 sum(Population[Sex == \"Females\"]),\n    .groups = \"drop\"\n  )\n\nggplot(lollipop_feats, aes(\n    x = reorder(Planning_Area, sex_ratio), \n    y = sex_ratio,\n    color = Region\n  )) +\n  geom_segment(aes(xend = Planning_Area, y = 1, yend = sex_ratio),\n               size = 0.5) +\n  geom_point(size = 3) +\n  coord_flip() +\n  labs(\n    title = \"Sex Ratio by Planning Area\",\n    x     = \"Planning Area\",\n    y     = \"Males per Females\"\n  ) +\n  theme_clean()\n```\n:::\n\n::::\n\n::: {style=\"background-color: #fffbe7; padding: 2em; border-radius: 12px\"}\n### Key insights from the visualization\n\n-   Most planning areas have a balanced or female-skewed population. Notable areas with significantly lower male-to-female ratios include: Seletar, Orchard, and Western Water Catchment, with ratios below 0.8, indicating more than 20% fewer males than females.\n\n-   Only a handful of planning areas have sex ratios above 1.0, indicating more males than females: Sungei Kadut has the highest ratio, significantly above 1.1, suggesting it may host male-dominated populations. Changi and Woodlands also have slightly higher male-to-female ratios, which could be influenced by military facilities, and industrial zones.\n:::\n\n# Summary and Conclusion\n\n\nThis report provides a multi-dimensional analysis of Singapore’s population using visualizations that examine distribution, age composition, dependency ratios, and sex ratios across regions and planning areas. The first set of visualizations reveals that while regions like the Central, North-East, and West have similar total populations, the Central region has significantly more planning areas and subzones, reflecting greater urban complexity and a more fragmented distribution. In some regions, certain planning areas such as Sengkang, Tampines, and Jurong West hold disproportionately large shares of the total populations, creating concentrated pressure on infrastructure and services.\n\nThe second visualization highlights demographic variation in age structure and dependency burden. The Central region has a notably higher proportion of elderly residents, while the North-East and West are younger. Areas like Outram and Bukit Merah face high dependency ratios, signaling greater economic pressure on the working-age population, whereas others like Seletar and Downtown Core show minimal dependency due to low residential or aging populations.\n\nLastly, the third visualization shows that most planning areas have balanced or female-skewed sex ratios, with only a few—such as Sungei Kadut and Changi—exhibiting a male-dominant population, likely linked to industrial or institutional functions.\n\nTogether, these insights highlight the demographic diversity across Singapore and underscore the need for region-specific urban planning and policy interventions.\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}