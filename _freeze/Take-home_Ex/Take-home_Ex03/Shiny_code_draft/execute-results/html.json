{
  "hash": "8474c0c1b1f2a2724065acf898b750e5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 3\"\nauthor: \"Quynh Trang Do\"\ndate: \"June 6, 2025\"\ndate-modified: \"last-modified\"\nformat: html\neditor: visual\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n# Load packages\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, jsonlite, dplyr, igraph,\n               tidygraph, ggraph, scales, visNetwork,\n               SmartEDA, widyr, ggforce, tidytext)\n```\n:::\n\n\n# Import data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMC3 <- fromJSON(\"data/MC3_graph.json\")\nMC3_schema <- fromJSON(\"data/MC3_schema.json\")\n```\n:::\n\n\n**Quick check on the imported data**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(MC3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 5\n $ directed  : logi TRUE\n $ multigraph: logi FALSE\n $ graph     :List of 4\n  ..$ mode        : chr \"static\"\n  ..$ edge_default: Named list()\n  ..$ node_default: Named list()\n  ..$ name        : chr \"VAST_MC3_Knowledge_Graph\"\n $ nodes     :'data.frame':\t1159 obs. of  31 variables:\n  ..$ type             : chr [1:1159] \"Entity\" \"Entity\" \"Entity\" \"Entity\" ...\n  ..$ label            : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ name             : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ sub_type         : chr [1:1159] \"Person\" \"Person\" \"Person\" \"Person\" ...\n  ..$ id               : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ timestamp        : chr [1:1159] NA NA NA NA ...\n  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...\n  ..$ findings         : chr [1:1159] NA NA NA NA ...\n  ..$ content          : chr [1:1159] NA NA NA NA ...\n  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...\n  ..$ results          : chr [1:1159] NA NA NA NA ...\n  ..$ movement_type    : chr [1:1159] NA NA NA NA ...\n  ..$ destination      : chr [1:1159] NA NA NA NA ...\n  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...\n  ..$ outcome          : chr [1:1159] NA NA NA NA ...\n  ..$ activity_type    : chr [1:1159] NA NA NA NA ...\n  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...\n  ..$ thing_collected  :'data.frame':\t1159 obs. of  2 variables:\n  .. ..$ type: chr [1:1159] NA NA NA NA ...\n  .. ..$ name: chr [1:1159] NA NA NA NA ...\n  ..$ reference        : chr [1:1159] NA NA NA NA ...\n  ..$ date             : chr [1:1159] NA NA NA NA ...\n  ..$ time             : chr [1:1159] NA NA NA NA ...\n  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...\n  ..$ permission_type  : chr [1:1159] NA NA NA NA ...\n  ..$ start_date       : chr [1:1159] NA NA NA NA ...\n  ..$ end_date         : chr [1:1159] NA NA NA NA ...\n  ..$ report_type      : chr [1:1159] NA NA NA NA ...\n  ..$ submission_date  : chr [1:1159] NA NA NA NA ...\n  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...\n  ..$ authority_level  : chr [1:1159] NA NA NA NA ...\n  ..$ coordination_type: chr [1:1159] NA NA NA NA ...\n  ..$ operational_role : chr [1:1159] NA NA NA NA ...\n $ edges     :'data.frame':\t3226 obs. of  5 variables:\n  ..$ id         : chr [1:3226] \"2\" \"3\" \"5\" \"3013\" ...\n  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...\n  ..$ source     : chr [1:3226] \"Sam\" \"Sam\" \"Sam\" \"Sam\" ...\n  ..$ target     : chr [1:3226] \"Relationship_Suspicious_217\" \"Event_Communication_370\" \"Event_Assessment_600\" \"Relationship_Colleagues_430\" ...\n  ..$ type       : chr [1:3226] NA \"sent\" NA NA ...\n```\n\n\n:::\n:::\n\n\n**Extract the node and edge tables**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_nodes <- as_tibble(MC3$nodes)\nmc3_edges <- as_tibble(MC3$edges)\n```\n:::\n\n\n# Data Cleaning and Wrangling\n\n## For nodes\n\nThe code chunk below is used to convert values in id field into character data type, exclude records with ID value are NA, exclude records with similar ID values, exclude thing_collected field, and save the cleaned tibble dataframe into a new tibble datatable called mc3_nodes_cleaned.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_nodes_cleaned <- mc3_nodes %>%\n  mutate(id = as.character(id)) %>%\n  filter(!is.na(id)) %>%\n  distinct(id, .keep_all = TRUE) %>%\n  select(-thing_collected)\n```\n:::\n\n\n## For edges\n\nThe code chunk below is used to rename source and target fields to from_id and to_id respectively, convert values in from_id and to_id fields to character data type, exclude values in from_id and to_id which not found in the id field of mc3_nodes_cleaned, exclude records whereby from_id and/or to_id values are missing, and save the cleaned tibble dataframe and called it mc3_edges_cleaned.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_edges_cleaned <- mc3_edges %>%\n  rename(from_id = source, \n         to_id = target) %>%\n  mutate(across(c(from_id, to_id), \n                as.character)) %>%\n  filter(from_id %in% mc3_nodes_cleaned$id, \n         to_id %in% mc3_nodes_cleaned$id) %>%\n  filter(!is.na(from_id), !is.na(to_id))\n```\n:::\n\n\nNext, create mapping of character id in mc3_nodes_cleaned to row index.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnode_index_lookup <- mc3_nodes_cleaned %>%\n  mutate(.row_id = row_number()) %>%\n  select(id, .row_id)\n```\n:::\n\n\nNext, join and convert from_id and to_id to integer indices. At the same time, drop rows with unmatched nodes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_edges_indexed <- mc3_edges_cleaned %>%\n  left_join(node_index_lookup, \n            by = c(\"from_id\" = \"id\")) %>%\n  rename(from = .row_id) %>%\n  left_join(node_index_lookup, \n            by = c(\"to_id\" = \"id\")) %>%\n  rename(to = .row_id) %>%\n  select(from, to, is_inferred, type) %>%\n  filter(!is.na(from) & !is.na(to))  \n```\n:::\n\n\nNext, subset nodes to only those referenced by edges.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nused_node_indices <- sort(\n  unique(c(mc3_edges_indexed$from, \n           mc3_edges_indexed$to)))\n\nmc3_nodes_final <- mc3_nodes_cleaned %>%\n  slice(used_node_indices) %>%\n  mutate(new_index = row_number())\n```\n:::\n\n\nThen, rebuild lookup from old index to new index.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nold_to_new_index <- tibble(\n  old_index = used_node_indices,\n  new_index = seq_along(\n    used_node_indices))\n```\n:::\n\n\nFinally, update edge indices to match new node table.\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_edges_final <- mc3_edges_indexed %>%\n  left_join(old_to_new_index, \n            by = c(\"from\" = \"old_index\")) %>%\n  rename(from_new = new_index) %>%\n  left_join(old_to_new_index, \n            by = c(\"to\" = \"old_index\")) %>%\n  rename(to_new = new_index) %>%\n  select(from = from_new, to = to_new, \n         is_inferred, type)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsubtype_map <- c(Coordinates = \"Operational\",\n  AccessPermission = \"Operational\",\n  Operates = \"Operational\",\n  Jurisdiction = \"Operational\",\n  Reports = \"Operational\",\n  Colleagues = \"Affiliates\",\n  Friends = \"Affiliates\",\n  Unfriendly = \"Unfriendly\",\n  Suspicious = \"Suspicious\"\n)\n\nundirected_types <- c(\"Friends\", \"Colleagues\")\n\n# ─────────────────────────────────────────────────────────────\n# 1. Filter nodes\n# ─────────────────────────────────────────────────────────────\nevent_ids <- mc3_nodes_final %>% filter(type == \"Event\") %>% pull(new_index)\nlocation_ids <- mc3_nodes_final %>% filter(sub_type == \"Location\") %>% pull(new_index)\nblocked_ids <- c(event_ids, location_ids)\n\nnode_lookup <- mc3_nodes_final %>% \n  filter(!new_index %in% blocked_ids) %>% \n  select(new_index, type, sub_type, label)\n\n# ─────────────────────────────────────────────────────────────\n# 2. Relationship nodes (no color use)\n# ─────────────────────────────────────────────────────────────\nrel_nodes <- node_lookup %>%\n  filter(type == \"Relationship\") %>%\n  mutate(\n    rel_subtype = sub_type,\n    big_group = ifelse(rel_subtype %in% names(subtype_map),\n                       subtype_map[rel_subtype],\n                       rel_subtype),\n    rel_id = as.character(new_index)\n  ) %>%\n  select(rel_id, rel_subtype, big_group)\n\nrel_ids <- rel_nodes$rel_id\nnondir_rel_ids <- rel_nodes %>% filter(rel_subtype %in% undirected_types) %>% pull(rel_id)\n\n# ─────────────────────────────────────────────────────────────\n# 3. All edges\n# ─────────────────────────────────────────────────────────────\nedges_all <- mc3_edges_final %>% \n  filter(from %in% node_lookup$new_index | to %in% node_lookup$new_index) %>%\n  filter(!from %in% blocked_ids, !to %in% blocked_ids) %>%\n  mutate(across(c(from, to), as.character))\n\nundir_edges <- edges_all %>% \n  filter(to %in% nondir_rel_ids) %>% \n  transmute(from = to, to = from, direction = \"undirected\")\n\nedges_all <- bind_rows(\n  edges_all %>% mutate(direction = \"directed\"),\n  undir_edges\n)\n\n# ─────────────────────────────────────────────────────────────\n# 4. Entity–Relationship table\n# ─────────────────────────────────────────────────────────────\nentity_rel_tbl <- edges_all %>%\n  filter(from %in% rel_ids | to %in% rel_ids) %>%\n  mutate(\n    rel_id = if_else(from %in% rel_ids, from, to),\n    entity = if_else(from %in% rel_ids, to, from)\n  ) %>%\n  select(rel_id, entity)\n\n# ─────────────────────────────────────────────────────────────\n# 5. Create and de-duplicate triplets\n# ─────────────────────────────────────────────────────────────\ntriplets <- entity_rel_tbl %>%\n  left_join(rel_nodes, by = \"rel_id\") %>%\n  group_by(rel_id) %>%\n  filter(n_distinct(entity) == 2) %>%\n  summarise(\n    entities = list(sort(unique(entity))),\n    rel_subtype = first(rel_subtype),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    e1 = map_chr(entities, ~.x[1]),\n    e2 = map_chr(entities, ~.x[2])\n  ) %>%\n  mutate(pair_id = paste(pmin(e1, e2), pmax(e1, e2), sep = \"_\")) %>%\n  arrange(pair_id, rel_subtype, rel_id) %>%\n  group_by(pair_id) %>%\n  slice(1) %>%\n  ungroup()\n\n# ─────────────────────────────────────────────────────────────\n# 6. Rebuild edge list\n# ─────────────────────────────────────────────────────────────\nedges_all <- triplets %>% \n  mutate(rel_type = if_else(rel_subtype %in% undirected_types, \"undirected\", \"directed\")) %>% \n  pivot_longer(c(e1, e2), names_to = \"end\", values_to = \"entity\") %>% \n  transmute(\n    from = if_else(end == \"e1\", entity, rel_id),\n    to = if_else(end == \"e1\", rel_id, entity),\n    direction = rel_type\n  ) %>% \n  distinct()\n\n# ─────────────────────────────────────────────────────────────\n# 7. Node table\n# ─────────────────────────────────────────────────────────────\nused_ids <- unique(c(edges_all$from, edges_all$to))\n\nnodes_tbl <- mc3_nodes_final %>% \n  filter(new_index %in% used_ids) %>% \n  mutate(\n    vis_type = case_when(\n      type == \"Relationship\" ~ \"Relationship\",\n      sub_type == \"Person\" ~ \"Person\",\n      sub_type == \"Organization\" ~ \"Organization\",\n      sub_type == \"Vessel\" ~ \"Vessel\", \n      sub_type == \"Group\" ~ \"Group\",\n      TRUE ~ \"Other\"\n    ),\n    new_index = as.character(new_index)\n  ) %>%\n  left_join(rel_nodes %>% select(node_id = rel_id, big_group), \n            by = c(\"new_index\" = \"node_id\")) %>%\n  mutate(\n    label = if_else(vis_type == \"Relationship\", big_group, label)\n  ) %>%\n  select(node_id = new_index, label, vis_type) %>%\n  mutate(row_id = row_number())\n\n# ─────────────────────────────────────────────────────────────\n# 8. Format for visNetwork\n# ─────────────────────────────────────────────────────────────\nid_map <- nodes_tbl %>% select(node_id, row_id)\n\nvis_edges <- edges_all %>% \n  left_join(id_map, by = c(\"from\" = \"node_id\")) %>% rename(.from = row_id) %>% \n  left_join(id_map, by = c(\"to\" = \"node_id\")) %>% rename(.to = row_id) %>% \n  transmute(\n    from = .from, \n    to = .to,\n    arrows = ifelse(direction == \"undirected\", \"\", \"to\"),\n    color = \"grey\"\n  )\n\n# ─────────────────────────────────────────────────────────────\n# 9. Colors and shapes (only by vis_type)\n# ─────────────────────────────────────────────────────────────\npalette <- c(\n  Person = \"orange\",\n  Organization = \"red\",\n  Vessel = \"forestgreen\",\n  Group = \"orchid\",\n  Relationship = \"skyblue\"\n)\n\nshapes <- c(\n  Person = \"dot\",\n  Organization = \"diamond\", \n  Vessel = \"triangle\",\n  Group = \"star\",\n  Relationship = \"box\"\n)\n\n# ─────────────────────────────────────────────────────────────\n# 10. Build vis_nodes table\n# ─────────────────────────────────────────────────────────────\nvis_nodes <- nodes_tbl %>%\n  left_join(rel_nodes %>% rename(node_id = rel_id), by = \"node_id\") %>%\n  mutate(\n    group = vis_type,\n    shape = shapes[vis_type],\n    color = palette[vis_type],\n    title = if_else(vis_type == \"Relationship\", rel_subtype, NA_character_)  # Tooltip for rel\n  ) %>%\n  transmute(\n    id = row_id,\n    label = if_else(group == \"Relationship\", big_group, label),\n    group = group,\n    shape = shape,\n    color = color,\n    title = title\n  )\n\n# ─────────────────────────────────────────────────────────────\n# 11. Final visNetwork graph\n# ─────────────────────────────────────────────────────────────\nvisNetwork(vis_nodes, vis_edges, width = \"100%\", height = \"800px\") %>% \n  visNodes(font = list(size = 18)) %>% \n  visEdges(smooth = FALSE) %>% \n  visOptions(\n    highlightNearest = list(enabled = TRUE, degree = 2, hover = TRUE),\n    nodesIdSelection = list(\n      enabled = TRUE,\n      values = vis_nodes %>% filter(!group %in% c(\"Relationship\", \"Other\")) %>% pull(id)\n    )\n  ) %>% \n  visLegend(\n    addNodes = data.frame(\n      label = names(palette),\n      shape = shapes[names(palette)],\n      color = palette[names(palette)]\n    ),\n    useGroups = FALSE,\n    position = \"right\"\n  ) %>% \n  visLayout(randomSeed = 42)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-6498ad41c11ab6a497d8\" style=\"width:100%;height:800px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6498ad41c11ab6a497d8\">{\"x\":{\"nodes\":{\"id\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136],\"label\":[\"Sam\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"Mariner's Dream\",\"Recreational Fishing Boats\",\"City Officials\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Unfriendly\",\"Unfriendly\"],\"group\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Group\",\"Group\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\",\"Relationship\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"diamond\",\"diamond\",\"diamond\",\"diamond\",\"diamond\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"star\",\"star\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\"],\"color\":[\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"red\",\"red\",\"red\",\"red\",\"red\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"orchid\",\"orchid\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\",\"skyblue\"],\"title\":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,\"AccessPermission\",\"AccessPermission\",\"AccessPermission\",\"AccessPermission\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Unfriendly\",\"Unfriendly\"]},\"edges\":{\"from\":[8,133,8,126,8,47,8,120,8,119,8,122,8,121,9,132,9,48,9,46,9,44,9,45,10,41,11,49,12,91,13,105,13,108,14,51,14,82,15,67,15,124,15,104,15,53,15,118,16,62,16,52,16,96,17,117,1,125,18,65,18,106,18,109,18,43,18,64,18,55,18,84,18,50,18,63,18,54,18,136,19,112,19,94,19,59,19,87,19,60,19,58,19,135,19,131,19,71,20,85,20,107,20,89,20,86,20,103,20,129,20,130,21,99,21,74,21,102,21,56,21,100,22,68,22,73,22,128,22,127,22,75,22,113,22,116,22,115,23,76,23,110,24,69,25,93,25,70,25,90,25,40,25,97,25,66,25,98,25,101,26,78,26,77,26,42,26,72,26,79,27,92,27,61,27,57,29,95,29,83,30,80,32,134,34,39,34,114,35,123,2,88,2,81,6,111],\"to\":[133,9,126,11,47,18,120,20,119,21,122,35,121,7,132,18,48,19,46,20,44,21,45,7,41,13,49,19,91,20,105,20,108,25,51,15,82,30,67,17,124,18,104,20,53,25,118,34,62,17,52,20,96,34,117,34,125,18,65,19,106,20,109,22,43,23,64,25,55,26,84,29,50,30,63,36,54,4,136,5,112,22,94,26,59,27,87,28,60,29,58,30,135,33,131,34,71,38,85,22,107,24,89,25,86,34,103,35,129,3,130,4,99,25,74,34,102,37,56,5,100,6,68,24,73,25,128,26,127,30,75,34,113,5,116,6,115,7,76,26,110,6,69,25,93,26,70,30,90,31,40,34,97,35,66,5,98,6,101,7,78,27,77,28,42,29,72,30,79,32,92,28,61,29,57,30,95,30,83,4,80,4,134,6,39,6,114,7,123,7,88,29,81,3,111,7],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"color\":[\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"font\":{\"size\":18}},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"interaction\":{\"hover\":true,\"zoomSpeed\":1},\"layout\":{\"randomSeed\":42}},\"groups\":[\"Person\",\"Organization\",\"Vessel\",\"Group\",\"Relationship\"],\"width\":\"100%\",\"height\":\"800px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\",\"values\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"highlight\":{\"enabled\":true,\"hoverNearest\":true,\"degree\":2,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":false,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"Person\",\"Organization\",\"Vessel\",\"Group\",\"Relationship\"],\"shape\":[\"dot\",\"diamond\",\"triangle\",\"star\",\"box\"],\"color\":[\"orange\",\"red\",\"forestgreen\",\"orchid\",\"skyblue\"]},\"nodesToDataframe\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(visNetwork)\nlibrary(RColorBrewer)\n\n# Choose clustering method\nclustering_method <- \"louvain\"  # options: \"louvain\" or \"label_prop\"\n\n# Make sure IDs are character\nvis_nodes <- vis_nodes %>% mutate(id = as.character(id))\nvis_edges <- vis_edges %>% mutate(from = as.character(from), to = as.character(to))\n\n# Build igraph object\ng <- graph_from_data_frame(d = vis_edges, vertices = vis_nodes, directed = TRUE)\ng_undirected <- as.undirected(g, mode = \"collapse\")\n\n# Apply clustering\nclusters <- switch(\n  clustering_method,\n  louvain     = cluster_louvain(g_undirected),\n  label_prop  = cluster_label_prop(g_undirected),\n  stop(\"Unsupported clustering method\")\n)\n\n# Cluster membership (ensure id matches vis_nodes$id)\nmembership_df <- data.frame(\n  id = names(membership(clusters)),\n  cluster_id = membership(clusters),\n  stringsAsFactors = FALSE\n)\n\n# Join and add color/group\nn_clusters <- length(unique(membership_df$cluster_id))\ncolor_palette <- RColorBrewer::brewer.pal(max(3, min(8, n_clusters)), \"Set2\")\n\nvis_nodes_clustered <- vis_nodes %>%\n  left_join(membership_df, by = \"id\") %>%\n  mutate(\n    group = paste0(\"Cluster \", cluster_id),\n    color = color_palette[as.numeric(factor(cluster_id))],\n    shape = shape  # preserve original shape if present\n  )\n\n# Draw graph\nvisNetwork(vis_nodes_clustered, vis_edges, width = \"100%\", height = \"800px\") %>% \n  visNodes(font = list(size = 18)) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(\n    highlightNearest = list(enabled = TRUE, degree = 2, hover = TRUE),\n    nodesIdSelection = TRUE\n  ) %>%\n  visLegend(useGroups = TRUE, position = \"right\") %>%\n  visLayout(randomSeed = 42)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-30678e41b64683288482\" style=\"width:100%;height:800px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-30678e41b64683288482\">{\"x\":{\"nodes\":{\"id\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\"],\"label\":[\"Sam\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"Mariner's Dream\",\"Recreational Fishing Boats\",\"City Officials\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Operational\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Unfriendly\",\"Unfriendly\"],\"group\":[\"Cluster 1\",\"Cluster 2\",\"Cluster 2\",\"Cluster 1\",\"Cluster 3\",\"Cluster 4\",\"Cluster 5\",\"Cluster 5\",\"Cluster 5\",\"Cluster 2\",\"Cluster 6\",\"Cluster 2\",\"Cluster 2\",\"Cluster 1\",\"Cluster 7\",\"Cluster 7\",\"Cluster 7\",\"Cluster 1\",\"Cluster 6\",\"Cluster 2\",\"Cluster 3\",\"Cluster 8\",\"Cluster 4\",\"Cluster 8\",\"Cluster 8\",\"Cluster 6\",\"Cluster 6\",\"Cluster 6\",\"Cluster 1\",\"Cluster 1\",\"Cluster 8\",\"Cluster 4\",\"Cluster 6\",\"Cluster 7\",\"Cluster 5\",\"Cluster 1\",\"Cluster 3\",\"Cluster 6\",\"Cluster 4\",\"Cluster 7\",\"Cluster 2\",\"Cluster 1\",\"Cluster 4\",\"Cluster 3\",\"Cluster 5\",\"Cluster 5\",\"Cluster 5\",\"Cluster 5\",\"Cluster 6\",\"Cluster 1\",\"Cluster 1\",\"Cluster 7\",\"Cluster 7\",\"Cluster 1\",\"Cluster 6\",\"Cluster 3\",\"Cluster 6\",\"Cluster 1\",\"Cluster 6\",\"Cluster 1\",\"Cluster 6\",\"Cluster 7\",\"Cluster 1\",\"Cluster 8\",\"Cluster 6\",\"Cluster 3\",\"Cluster 7\",\"Cluster 8\",\"Cluster 8\",\"Cluster 1\",\"Cluster 6\",\"Cluster 1\",\"Cluster 8\",\"Cluster 3\",\"Cluster 7\",\"Cluster 4\",\"Cluster 6\",\"Cluster 6\",\"Cluster 4\",\"Cluster 1\",\"Cluster 2\",\"Cluster 1\",\"Cluster 1\",\"Cluster 1\",\"Cluster 8\",\"Cluster 7\",\"Cluster 6\",\"Cluster 2\",\"Cluster 2\",\"Cluster 8\",\"Cluster 2\",\"Cluster 6\",\"Cluster 6\",\"Cluster 6\",\"Cluster 1\",\"Cluster 7\",\"Cluster 5\",\"Cluster 4\",\"Cluster 3\",\"Cluster 3\",\"Cluster 5\",\"Cluster 3\",\"Cluster 5\",\"Cluster 7\",\"Cluster 2\",\"Cluster 2\",\"Cluster 8\",\"Cluster 2\",\"Cluster 8\",\"Cluster 4\",\"Cluster 4\",\"Cluster 8\",\"Cluster 3\",\"Cluster 5\",\"Cluster 5\",\"Cluster 4\",\"Cluster 7\",\"Cluster 7\",\"Cluster 5\",\"Cluster 5\",\"Cluster 5\",\"Cluster 5\",\"Cluster 5\",\"Cluster 7\",\"Cluster 1\",\"Cluster 6\",\"Cluster 1\",\"Cluster 6\",\"Cluster 2\",\"Cluster 1\",\"Cluster 6\",\"Cluster 5\",\"Cluster 5\",\"Cluster 4\",\"Cluster 6\",\"Cluster 3\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"diamond\",\"diamond\",\"diamond\",\"diamond\",\"diamond\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"star\",\"star\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\",\"box\"],\"color\":[\"#66C2A5\",\"#FC8D62\",\"#FC8D62\",\"#66C2A5\",\"#8DA0CB\",\"#E78AC3\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#FC8D62\",\"#FFD92F\",\"#FC8D62\",\"#FC8D62\",\"#66C2A5\",\"#E5C494\",\"#E5C494\",\"#E5C494\",\"#66C2A5\",\"#FFD92F\",\"#FC8D62\",\"#8DA0CB\",\"#B3B3B3\",\"#E78AC3\",\"#B3B3B3\",\"#B3B3B3\",\"#FFD92F\",\"#FFD92F\",\"#FFD92F\",\"#66C2A5\",\"#66C2A5\",\"#B3B3B3\",\"#E78AC3\",\"#FFD92F\",\"#E5C494\",\"#A6D854\",\"#66C2A5\",\"#8DA0CB\",\"#FFD92F\",\"#E78AC3\",\"#E5C494\",\"#FC8D62\",\"#66C2A5\",\"#E78AC3\",\"#8DA0CB\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#FFD92F\",\"#66C2A5\",\"#66C2A5\",\"#E5C494\",\"#E5C494\",\"#66C2A5\",\"#FFD92F\",\"#8DA0CB\",\"#FFD92F\",\"#66C2A5\",\"#FFD92F\",\"#66C2A5\",\"#FFD92F\",\"#E5C494\",\"#66C2A5\",\"#B3B3B3\",\"#FFD92F\",\"#8DA0CB\",\"#E5C494\",\"#B3B3B3\",\"#B3B3B3\",\"#66C2A5\",\"#FFD92F\",\"#66C2A5\",\"#B3B3B3\",\"#8DA0CB\",\"#E5C494\",\"#E78AC3\",\"#FFD92F\",\"#FFD92F\",\"#E78AC3\",\"#66C2A5\",\"#FC8D62\",\"#66C2A5\",\"#66C2A5\",\"#66C2A5\",\"#B3B3B3\",\"#E5C494\",\"#FFD92F\",\"#FC8D62\",\"#FC8D62\",\"#B3B3B3\",\"#FC8D62\",\"#FFD92F\",\"#FFD92F\",\"#FFD92F\",\"#66C2A5\",\"#E5C494\",\"#A6D854\",\"#E78AC3\",\"#8DA0CB\",\"#8DA0CB\",\"#A6D854\",\"#8DA0CB\",\"#A6D854\",\"#E5C494\",\"#FC8D62\",\"#FC8D62\",\"#B3B3B3\",\"#FC8D62\",\"#B3B3B3\",\"#E78AC3\",\"#E78AC3\",\"#B3B3B3\",\"#8DA0CB\",\"#A6D854\",\"#A6D854\",\"#E78AC3\",\"#E5C494\",\"#E5C494\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#E5C494\",\"#66C2A5\",\"#FFD92F\",\"#66C2A5\",\"#FFD92F\",\"#FC8D62\",\"#66C2A5\",\"#FFD92F\",\"#A6D854\",\"#A6D854\",\"#E78AC3\",\"#FFD92F\",\"#8DA0CB\"],\"title\":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,\"AccessPermission\",\"AccessPermission\",\"AccessPermission\",\"AccessPermission\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Reports\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Coordinates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Operates\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Suspicious\",\"Unfriendly\",\"Unfriendly\"],\"cluster_id\":[1,2,2,1,3,4,5,5,5,2,6,2,2,1,7,7,7,1,6,2,3,8,4,8,8,6,6,6,1,1,8,4,6,7,5,1,3,6,4,7,2,1,4,3,5,5,5,5,6,1,1,7,7,1,6,3,6,1,6,1,6,7,1,8,6,3,7,8,8,1,6,1,8,3,7,4,6,6,4,1,2,1,1,1,8,7,6,2,2,8,2,6,6,6,1,7,5,4,3,3,5,3,5,7,2,2,8,2,8,4,4,8,3,5,5,4,7,7,5,5,5,5,5,7,1,6,1,6,2,1,6,5,5,4,6,3]},\"edges\":{\"from\":[\"8\",\"133\",\"8\",\"126\",\"8\",\"47\",\"8\",\"120\",\"8\",\"119\",\"8\",\"122\",\"8\",\"121\",\"9\",\"132\",\"9\",\"48\",\"9\",\"46\",\"9\",\"44\",\"9\",\"45\",\"10\",\"41\",\"11\",\"49\",\"12\",\"91\",\"13\",\"105\",\"13\",\"108\",\"14\",\"51\",\"14\",\"82\",\"15\",\"67\",\"15\",\"124\",\"15\",\"104\",\"15\",\"53\",\"15\",\"118\",\"16\",\"62\",\"16\",\"52\",\"16\",\"96\",\"17\",\"117\",\"1\",\"125\",\"18\",\"65\",\"18\",\"106\",\"18\",\"109\",\"18\",\"43\",\"18\",\"64\",\"18\",\"55\",\"18\",\"84\",\"18\",\"50\",\"18\",\"63\",\"18\",\"54\",\"18\",\"136\",\"19\",\"112\",\"19\",\"94\",\"19\",\"59\",\"19\",\"87\",\"19\",\"60\",\"19\",\"58\",\"19\",\"135\",\"19\",\"131\",\"19\",\"71\",\"20\",\"85\",\"20\",\"107\",\"20\",\"89\",\"20\",\"86\",\"20\",\"103\",\"20\",\"129\",\"20\",\"130\",\"21\",\"99\",\"21\",\"74\",\"21\",\"102\",\"21\",\"56\",\"21\",\"100\",\"22\",\"68\",\"22\",\"73\",\"22\",\"128\",\"22\",\"127\",\"22\",\"75\",\"22\",\"113\",\"22\",\"116\",\"22\",\"115\",\"23\",\"76\",\"23\",\"110\",\"24\",\"69\",\"25\",\"93\",\"25\",\"70\",\"25\",\"90\",\"25\",\"40\",\"25\",\"97\",\"25\",\"66\",\"25\",\"98\",\"25\",\"101\",\"26\",\"78\",\"26\",\"77\",\"26\",\"42\",\"26\",\"72\",\"26\",\"79\",\"27\",\"92\",\"27\",\"61\",\"27\",\"57\",\"29\",\"95\",\"29\",\"83\",\"30\",\"80\",\"32\",\"134\",\"34\",\"39\",\"34\",\"114\",\"35\",\"123\",\"2\",\"88\",\"2\",\"81\",\"6\",\"111\"],\"to\":[\"133\",\"9\",\"126\",\"11\",\"47\",\"18\",\"120\",\"20\",\"119\",\"21\",\"122\",\"35\",\"121\",\"7\",\"132\",\"18\",\"48\",\"19\",\"46\",\"20\",\"44\",\"21\",\"45\",\"7\",\"41\",\"13\",\"49\",\"19\",\"91\",\"20\",\"105\",\"20\",\"108\",\"25\",\"51\",\"15\",\"82\",\"30\",\"67\",\"17\",\"124\",\"18\",\"104\",\"20\",\"53\",\"25\",\"118\",\"34\",\"62\",\"17\",\"52\",\"20\",\"96\",\"34\",\"117\",\"34\",\"125\",\"18\",\"65\",\"19\",\"106\",\"20\",\"109\",\"22\",\"43\",\"23\",\"64\",\"25\",\"55\",\"26\",\"84\",\"29\",\"50\",\"30\",\"63\",\"36\",\"54\",\"4\",\"136\",\"5\",\"112\",\"22\",\"94\",\"26\",\"59\",\"27\",\"87\",\"28\",\"60\",\"29\",\"58\",\"30\",\"135\",\"33\",\"131\",\"34\",\"71\",\"38\",\"85\",\"22\",\"107\",\"24\",\"89\",\"25\",\"86\",\"34\",\"103\",\"35\",\"129\",\"3\",\"130\",\"4\",\"99\",\"25\",\"74\",\"34\",\"102\",\"37\",\"56\",\"5\",\"100\",\"6\",\"68\",\"24\",\"73\",\"25\",\"128\",\"26\",\"127\",\"30\",\"75\",\"34\",\"113\",\"5\",\"116\",\"6\",\"115\",\"7\",\"76\",\"26\",\"110\",\"6\",\"69\",\"25\",\"93\",\"26\",\"70\",\"30\",\"90\",\"31\",\"40\",\"34\",\"97\",\"35\",\"66\",\"5\",\"98\",\"6\",\"101\",\"7\",\"78\",\"27\",\"77\",\"28\",\"42\",\"29\",\"72\",\"30\",\"79\",\"32\",\"92\",\"28\",\"61\",\"29\",\"57\",\"30\",\"95\",\"30\",\"83\",\"4\",\"80\",\"4\",\"134\",\"6\",\"39\",\"6\",\"114\",\"7\",\"123\",\"7\",\"88\",\"29\",\"81\",\"3\",\"111\",\"7\"],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"color\":[\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\",\"grey\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"font\":{\"size\":18}},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"interaction\":{\"hover\":true,\"zoomSpeed\":1},\"layout\":{\"randomSeed\":42}},\"groups\":[\"Cluster 1\",\"Cluster 2\",\"Cluster 3\",\"Cluster 4\",\"Cluster 5\",\"Cluster 6\",\"Cluster 7\",\"Cluster 8\"],\"width\":\"100%\",\"height\":\"800px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"highlight\":{\"enabled\":true,\"hoverNearest\":true,\"degree\":2,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nV(g_undirected)$name <- vis_nodes$id\n\n# Compute centrality measures\ncentrality_df <- data.frame(\n  id = V(g_undirected)$name,\n  degree = degree(g_undirected),\n  betweenness = betweenness(g_undirected, normalized = TRUE),\n  closeness = closeness(g_undirected, normalized = TRUE),\n  eigenvector = eigen_centrality(g_undirected)$vector,\n  stringsAsFactors = FALSE\n)\n\n# Merge with vis_nodes to get name and sub-type\nvis_nodes_clean <- nodes_tbl %>% \n  select(id = row_id, label, sub_type = vis_type)\n\ncentrality_df <- centrality_df %>% mutate(id = as.character(id))\nvis_nodes_clean <- vis_nodes_clean %>% mutate(id = as.character(id))\nmembership_df <- membership_df %>% mutate(id = as.character(id))\n\n\ncentrality_table <- centrality_df %>%\n  left_join(vis_nodes_clean %>% select(id, Name = label, `Sub-type` = sub_type), by = \"id\") %>%\n  left_join(membership_df, by = \"id\") %>%\n  select(Name, `Sub-type`, Cluster = cluster_id,\n         `Degree centrality` = degree,\n         `Betweenness centrality` = betweenness,\n         `Closeness centrality` = closeness,\n         `Eigenvector centrality` = eigenvector) %>%\n  mutate(across(where(is.numeric), ~ round(.x, 2)))\n\n\n# round numeric metrics\ncentrality_table <- centrality_table %>%\n  mutate(across(where(is.numeric), ~ round(.x, 2)))\n\nprint(centrality_table)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          Name     Sub-type Cluster Degree centrality\n1                          Sam       Person       1                 1\n2                  Nadia Conti       Person       2                 2\n3                        Elise       Person       2                 2\n4                  Liam Thorne       Person       1                 4\n5               Samantha Blake       Person       3                 4\n6                        Davis       Person       4                 7\n7                    Rodriguez       Person       5                 7\n8               Clepper Jensen       Person       5                 7\n9               Miranda Jordan       Person       5                 6\n10                  The Intern       Person       2                 1\n11                 The Lookout       Person       6                 2\n12              The Accountant       Person       2                 1\n13                  Mrs. Money       Person       2                 3\n14               The Middleman       Person       1                 2\n15                        Boss       Person       7                 6\n16                   Small Fry       Person       7                 3\n17               Glitters Team Organization       7                 3\n18        Oceanus City Council Organization       1                15\n19             Green Guardians Organization       6                12\n20          V. Miesel Shipping Organization       2                14\n21          Sailor Shifts Team Organization       3                 7\n22                     Neptune       Vessel       8                11\n23                      Marlin       Vessel       4                 3\n24                    Serenity       Vessel       8                 3\n25                        Mako       Vessel       8                15\n26               Reef Guardian       Vessel       6                10\n27                     Horizon       Vessel       6                 5\n28                    Seawatch       Vessel       6                 3\n29                    EcoVigil       Vessel       1                 7\n30                    Sentinel       Vessel       1                 9\n31                      Osprey       Vessel       8                 1\n32                    Defender       Vessel       4                 2\n33              Northern Light       Vessel       6                 1\n34                      Remora       Vessel       7                10\n35                     Knowles       Vessel       5                 4\n36             Mariner's Dream       Vessel       1                 1\n37  Recreational Fishing Boats        Group       3                 1\n38              City Officials        Group       6                 1\n39                 Operational Relationship       4                 2\n40                 Operational Relationship       7                 2\n41                 Operational Relationship       2                 2\n42                 Operational Relationship       1                 2\n43                 Operational Relationship       4                 2\n44                 Operational Relationship       3                 2\n45                 Operational Relationship       5                 2\n46                 Operational Relationship       5                 2\n47                 Operational Relationship       5                 2\n48                 Operational Relationship       5                 2\n49                 Operational Relationship       6                 2\n50                 Operational Relationship       1                 2\n51                 Operational Relationship       1                 2\n52                 Operational Relationship       7                 2\n53                 Operational Relationship       7                 2\n54                 Operational Relationship       1                 2\n55                 Operational Relationship       6                 2\n56                 Operational Relationship       3                 2\n57                 Operational Relationship       6                 2\n58                 Operational Relationship       1                 2\n59                 Operational Relationship       6                 2\n60                 Operational Relationship       1                 2\n61                 Operational Relationship       6                 2\n62                 Operational Relationship       7                 2\n63                 Operational Relationship       1                 2\n64                 Operational Relationship       8                 2\n65                 Operational Relationship       6                 2\n66                 Operational Relationship       3                 2\n67                 Operational Relationship       7                 2\n68                 Operational Relationship       8                 2\n69                 Operational Relationship       8                 2\n70                 Operational Relationship       1                 2\n71                 Operational Relationship       6                 2\n72                 Operational Relationship       1                 2\n73                 Operational Relationship       8                 2\n74                 Operational Relationship       3                 2\n75                 Operational Relationship       7                 2\n76                 Operational Relationship       4                 2\n77                 Operational Relationship       6                 2\n78                 Operational Relationship       6                 2\n79                 Operational Relationship       4                 2\n80                 Operational Relationship       1                 2\n81                 Operational Relationship       2                 2\n82                 Operational Relationship       1                 2\n83                 Operational Relationship       1                 2\n84                 Operational Relationship       1                 2\n85                 Operational Relationship       8                 2\n86                 Operational Relationship       7                 2\n87                 Operational Relationship       6                 2\n88                 Operational Relationship       2                 2\n89                 Operational Relationship       2                 2\n90                 Operational Relationship       8                 2\n91                 Operational Relationship       2                 2\n92                 Operational Relationship       6                 2\n93                 Operational Relationship       6                 2\n94                 Operational Relationship       6                 2\n95                 Operational Relationship       1                 2\n96                 Operational Relationship       7                 2\n97                 Operational Relationship       5                 2\n98                 Operational Relationship       4                 2\n99                 Operational Relationship       3                 2\n100                Operational Relationship       3                 2\n101                Operational Relationship       5                 2\n102                Operational Relationship       3                 2\n103                Operational Relationship       5                 2\n104                Operational Relationship       7                 2\n105                Operational Relationship       2                 2\n106                Operational Relationship       2                 2\n107                Operational Relationship       8                 2\n108                Operational Relationship       2                 2\n109                Operational Relationship       8                 2\n110                Operational Relationship       4                 2\n111                Operational Relationship       4                 2\n112                Operational Relationship       8                 2\n113                Operational Relationship       3                 2\n114                Operational Relationship       5                 2\n115                Operational Relationship       5                 2\n116                Operational Relationship       4                 2\n117                Operational Relationship       7                 2\n118                Operational Relationship       7                 2\n119                 Suspicious Relationship       5                 2\n120                 Suspicious Relationship       5                 2\n121                 Suspicious Relationship       5                 2\n122                 Suspicious Relationship       5                 2\n123                 Suspicious Relationship       5                 2\n124                 Suspicious Relationship       7                 2\n125                 Suspicious Relationship       1                 2\n126                 Suspicious Relationship       6                 2\n127                 Suspicious Relationship       1                 2\n128                 Suspicious Relationship       6                 2\n129                 Suspicious Relationship       2                 2\n130                 Suspicious Relationship       1                 2\n131                 Suspicious Relationship       6                 2\n132                 Suspicious Relationship       5                 2\n133                 Suspicious Relationship       5                 2\n134                 Suspicious Relationship       4                 2\n135                 Unfriendly Relationship       6                 2\n136                 Unfriendly Relationship       3                 2\n    Betweenness centrality Closeness centrality Eigenvector centrality\n1                     0.00                 0.20                   0.05\n2                     0.01                 0.18                   0.01\n3                     0.01                 0.20                   0.04\n4                     0.02                 0.24                   0.14\n5                     0.02                 0.24                   0.17\n6                     0.05                 0.24                   0.19\n7                     0.05                 0.25                   0.21\n8                     0.06                 0.25                   0.19\n9                     0.05                 0.26                   0.20\n10                    0.00                 0.15                   0.01\n11                    0.01                 0.20                   0.03\n12                    0.00                 0.19                   0.04\n13                    0.03                 0.22                   0.10\n14                    0.00                 0.20                   0.03\n15                    0.05                 0.26                   0.23\n16                    0.01                 0.21                   0.07\n17                    0.01                 0.20                   0.04\n18                    0.24                 0.33                   1.00\n19                    0.18                 0.28                   0.42\n20                    0.21                 0.30                   0.73\n21                    0.06                 0.24                   0.17\n22                    0.13                 0.31                   0.56\n23                    0.01                 0.22                   0.09\n24                    0.01                 0.23                   0.14\n25                    0.23                 0.32                   1.00\n26                    0.12                 0.28                   0.39\n27                    0.02                 0.21                   0.10\n28                    0.01                 0.20                   0.05\n29                    0.06                 0.24                   0.19\n30                    0.09                 0.28                   0.35\n31                    0.00                 0.20                   0.05\n32                    0.00                 0.20                   0.03\n33                    0.00                 0.18                   0.02\n34                    0.13                 0.29                   0.37\n35                    0.02                 0.23                   0.13\n36                    0.00                 0.20                   0.05\n37                    0.00                 0.16                   0.01\n38                    0.00                 0.18                   0.02\n39                    0.01                 0.23                   0.13\n40                    0.02                 0.27                   0.31\n41                    0.01                 0.18                   0.02\n42                    0.01                 0.23                   0.13\n43                    0.01                 0.25                   0.25\n44                    0.01                 0.23                   0.08\n45                    0.01                 0.24                   0.09\n46                    0.02                 0.25                   0.21\n47                    0.03                 0.26                   0.27\n48                    0.02                 0.25                   0.14\n49                    0.01                 0.23                   0.10\n50                    0.02                 0.26                   0.30\n51                    0.01                 0.21                   0.06\n52                    0.02                 0.23                   0.18\n53                    0.02                 0.25                   0.28\n54                    0.01                 0.25                   0.26\n55                    0.02                 0.26                   0.31\n56                    0.01                 0.21                   0.08\n57                    0.01                 0.22                   0.10\n58                    0.02                 0.24                   0.17\n59                    0.01                 0.22                   0.12\n60                    0.02                 0.23                   0.14\n61                    0.00                 0.20                   0.06\n62                    0.00                 0.18                   0.02\n63                    0.01                 0.25                   0.24\n64                    0.03                 0.28                   0.45\n65                    0.03                 0.27                   0.32\n66                    0.01                 0.25                   0.26\n67                    0.01                 0.21                   0.06\n68                    0.01                 0.24                   0.16\n69                    0.01                 0.25                   0.26\n70                    0.03                 0.27                   0.30\n71                    0.01                 0.22                   0.10\n72                    0.01                 0.23                   0.17\n73                    0.01                 0.26                   0.35\n74                    0.02                 0.24                   0.12\n75                    0.01                 0.26                   0.21\n76                    0.01                 0.22                   0.11\n77                    0.01                 0.22                   0.10\n78                    0.01                 0.22                   0.11\n79                    0.01                 0.22                   0.09\n80                    0.01                 0.23                   0.11\n81                    0.01                 0.18                   0.01\n82                    0.01                 0.22                   0.09\n83                    0.01                 0.21                   0.07\n84                    0.03                 0.26                   0.27\n85                    0.03                 0.27                   0.29\n86                    0.03                 0.26                   0.25\n87                    0.01                 0.22                   0.11\n88                    0.02                 0.20                   0.05\n89                    0.03                 0.27                   0.39\n90                    0.01                 0.24                   0.24\n91                    0.01                 0.23                   0.17\n92                    0.00                 0.18                   0.03\n93                    0.04                 0.27                   0.31\n94                    0.02                 0.24                   0.18\n95                    0.01                 0.22                   0.12\n96                    0.01                 0.23                   0.10\n97                    0.01                 0.25                   0.26\n98                    0.02                 0.25                   0.27\n99                    0.03                 0.26                   0.26\n100                   0.01                 0.21                   0.08\n101                   0.01                 0.26                   0.27\n102                   0.01                 0.20                   0.04\n103                   0.01                 0.24                   0.19\n104                   0.01                 0.24                   0.22\n105                   0.02                 0.23                   0.19\n106                   0.04                 0.28                   0.39\n107                   0.01                 0.23                   0.19\n108                   0.03                 0.25                   0.25\n109                   0.02                 0.27                   0.35\n110                   0.01                 0.22                   0.06\n111                   0.01                 0.21                   0.09\n112                   0.03                 0.26                   0.22\n113                   0.01                 0.25                   0.17\n114                   0.01                 0.24                   0.13\n115                   0.01                 0.25                   0.17\n116                   0.01                 0.25                   0.17\n117                   0.01                 0.23                   0.09\n118                   0.01                 0.24                   0.13\n119                   0.01                 0.22                   0.08\n120                   0.02                 0.24                   0.21\n121                   0.01                 0.23                   0.09\n122                   0.00                 0.21                   0.07\n123                   0.00                 0.21                   0.08\n124                   0.02                 0.26                   0.28\n125                   0.01                 0.25                   0.24\n126                   0.01                 0.21                   0.05\n127                   0.02                 0.25                   0.21\n128                   0.02                 0.26                   0.21\n129                   0.03                 0.23                   0.17\n130                   0.02                 0.24                   0.20\n131                   0.05                 0.27                   0.18\n132                   0.02                 0.26                   0.27\n133                   0.00                 0.21                   0.09\n134                   0.01                 0.21                   0.05\n135                   0.01                 0.22                   0.10\n136                   0.01                 0.25                   0.26\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Build Communication tables\nvalid_entity_types <- c(\"Person\", \"Organization\", \"Vessel\", \"Group\")\n\nnode_lookup <- mc3_nodes_final %>% select(new_index, sub_type, name)\nedges_labeled <- mc3_edges_final %>%\n  left_join(node_lookup, by = c(\"from\" = \"new_index\")) %>%\n  rename(from_type = sub_type, from_name = name) %>%\n  left_join(node_lookup, by = c(\"to\" = \"new_index\")) %>%\n  rename(to_type = sub_type, to_name = name)\n\nentity_comm <- edges_labeled %>%\n  filter(\n    (from_type %in% valid_entity_types & to_type == \"Communication\") |\n    (to_type %in% valid_entity_types & from_type == \"Communication\")\n  ) %>%\n  transmute(\n    entity = if_else(from_type %in% valid_entity_types, from_name, to_name),\n    comm   = if_else(from_type %in% valid_entity_types, to, from),\n    type   = if_else(from_type %in% valid_entity_types, from_type, to_type)\n  )\n\n# Pairwise co-occurrences\nedges_raw <- entity_comm %>%\n  inner_join(entity_comm, by = \"comm\", suffix = c(\"_a\", \"_b\")) %>%\n  filter(entity_a != entity_b) %>%\n  mutate(pair_id = map2_chr(entity_a, entity_b, ~ paste(sort(c(.x, .y)), collapse = \"||\"))) %>%\n  count(pair_id, entity_a, entity_b, name = \"weight\")\n\n# Node table\nnodes_tbl <- entity_comm %>%\n  distinct(name = entity, sub_type = type) %>%\n  mutate(row_id = row_number())\n\n# Edge table\nid_lkp <- nodes_tbl %>% select(name, row_id)\nedges_final <- edges_raw %>%\n  left_join(id_lkp, by = c(\"entity_a\" = \"name\")) %>% rename(from = row_id) %>%\n  left_join(id_lkp, by = c(\"entity_b\" = \"name\")) %>% rename(to = row_id) %>%\n  select(from, to, weight)\n\nfull_graph <- tbl_graph(nodes = nodes_tbl, edges = edges_final, directed = FALSE) %>%\n  mutate(\n    degree      = centrality_degree(),\n    betweenness = centrality_betweenness(),\n    closeness   = centrality_closeness(),\n    eigen       = centrality_eigen()\n  )\n\n# Visualize\nvis_nodes <- full_graph %>%\n  as_tibble() %>%\n  mutate(\n    id = row_number(),\n    label = name,\n    value = scales::rescale(degree, to = c(5, 25)),  # Size by degree\n    group = sub_type,\n    color = case_when(\n    sub_type == \"Person\"       ~ \"orange\",\n    sub_type == \"Vessel\"       ~ \"forestgreen\",\n    sub_type == \"Organization\" ~ \"pink\",\n    sub_type == \"Group\"        ~ \"blue\",\n    TRUE ~ \"lightgray\"\n    ),\n    shape = case_when(\n    sub_type == \"Person\"       ~ \"dot\",\n    sub_type == \"Vessel\"       ~ \"triangle\",\n    sub_type == \"Organization\" ~ \"box\",\n    sub_type == \"Group\"        ~ \"star\",\n    TRUE ~ \"ellipse\"\n    ),\n    title = paste0(\n      \"<b>\", name, \"</b><br>\",\n      \"Degree: \", degree, \"<br>\",\n      \"Betweenness: \", round(betweenness, 2), \"<br>\",\n      \"Closeness: \", round(closeness, 3), \"<br>\",\n      \"Eigenvector: \", round(eigen, 3)\n    )\n  ) %>%\n  select(id, label, group, shape, color, value, title)\n\nvis_edges <- edges_final %>%\n  mutate(arrows = \"none\", color = \"gray\") %>%\n  distinct()\n\nvisNetwork(vis_nodes, vis_edges) %>%\n  visNodes(font = list(size = 16)) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(\n    highlightNearest = list(enabled = TRUE, degree = 1, hover = TRUE),\n    nodesIdSelection = TRUE\n  ) %>%\n  visLayout(randomSeed = 42) %>%\n  visLegend(addNodes = data.frame(\n  label = c(\"Person\", \"Vessel\", \"Organization\", \"Group\"),\n  shape = c(\"dot\", \"triangle\", \"box\", \"star\"),\n  color = c(\"orange\", \"forestgreen\", \"pink\", \"blue\")\n), useGroups = FALSE, position = \"right\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-7ba58626d448577d6c70\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7ba58626d448577d6c70\">{\"x\":{\"nodes\":{\"id\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\"],\"group\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Group\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"box\",\"box\",\"box\",\"box\",\"box\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"star\"],\"color\":[\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"orange\",\"pink\",\"pink\",\"pink\",\"pink\",\"pink\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"forestgreen\",\"blue\"],\"value\":[6.052631578947368,5,15.52631578947368,9.210526315789473,10.26315789473684,8.157894736842106,13.42105263157895,11.31578947368421,5,5,6.052631578947368,10.26315789473684,6.052631578947368,12.36842105263158,8.157894736842106,13.42105263157895,7.105263157894736,8.157894736842106,15.52631578947368,13.42105263157895,13.42105263157895,10.26315789473684,14.47368421052632,9.210526315789473,7.105263157894736,25,16.57894736842105,12.36842105263158,9.210526315789473,10.26315789473684,13.42105263157895,5,7.105263157894736,8.157894736842106,15.52631578947368,6.052631578947368,5],\"title\":[\"<b>Sam<\\/b><br>Degree: 4<br>Betweenness: 33<br>Closeness: 0.009<br>Eigenvector: 0.032\",\"<b>Kelly<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 0.007<br>Eigenvector: 0.004\",\"<b>Nadia Conti<\\/b><br>Degree: 22<br>Betweenness: 30.16<br>Closeness: 0.016<br>Eigenvector: 0.635\",\"<b>Elise<\\/b><br>Degree: 10<br>Betweenness: 3.24<br>Closeness: 0.014<br>Eigenvector: 0.365\",\"<b>Liam Thorne<\\/b><br>Degree: 12<br>Betweenness: 16.03<br>Closeness: 0.013<br>Eigenvector: 0.3\",\"<b>Samantha Blake<\\/b><br>Degree: 8<br>Betweenness: 3.87<br>Closeness: 0.013<br>Eigenvector: 0.253\",\"<b>Davis<\\/b><br>Degree: 18<br>Betweenness: 13.62<br>Closeness: 0.014<br>Eigenvector: 0.555\",\"<b>Rodriguez<\\/b><br>Degree: 14<br>Betweenness: 4.41<br>Closeness: 0.013<br>Eigenvector: 0.428\",\"<b>Clepper Jensen<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 1<br>Eigenvector: 0\",\"<b>Miranda Jordan<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 1<br>Eigenvector: 0\",\"<b>The Intern<\\/b><br>Degree: 4<br>Betweenness: 9.9<br>Closeness: 0.012<br>Eigenvector: 0.085\",\"<b>The Lookout<\\/b><br>Degree: 12<br>Betweenness: 73.17<br>Closeness: 0.013<br>Eigenvector: 0.275\",\"<b>The Accountant<\\/b><br>Degree: 4<br>Betweenness: 0<br>Closeness: 0.01<br>Eigenvector: 0.067\",\"<b>Mrs. Money<\\/b><br>Degree: 16<br>Betweenness: 40.49<br>Closeness: 0.015<br>Eigenvector: 0.457\",\"<b>The Middleman<\\/b><br>Degree: 8<br>Betweenness: 4.95<br>Closeness: 0.012<br>Eigenvector: 0.146\",\"<b>Boss<\\/b><br>Degree: 18<br>Betweenness: 49.3<br>Closeness: 0.015<br>Eigenvector: 0.433\",\"<b>Small Fry<\\/b><br>Degree: 6<br>Betweenness: 0<br>Closeness: 0.013<br>Eigenvector: 0.255\",\"<b>Glitters Team<\\/b><br>Degree: 8<br>Betweenness: 6.38<br>Closeness: 0.012<br>Eigenvector: 0.177\",\"<b>Oceanus City Council<\\/b><br>Degree: 22<br>Betweenness: 30.58<br>Closeness: 0.016<br>Eigenvector: 0.629\",\"<b>Green Guardians<\\/b><br>Degree: 18<br>Betweenness: 30.77<br>Closeness: 0.016<br>Eigenvector: 0.521\",\"<b>V. Miesel Shipping<\\/b><br>Degree: 18<br>Betweenness: 6.69<br>Closeness: 0.015<br>Eigenvector: 0.595\",\"<b>Sailor Shifts Team<\\/b><br>Degree: 12<br>Betweenness: 9.55<br>Closeness: 0.014<br>Eigenvector: 0.366\",\"<b>Neptune<\\/b><br>Degree: 20<br>Betweenness: 46.82<br>Closeness: 0.016<br>Eigenvector: 0.609\",\"<b>Marlin<\\/b><br>Degree: 10<br>Betweenness: 2.22<br>Closeness: 0.014<br>Eigenvector: 0.414\",\"<b>Serenity<\\/b><br>Degree: 6<br>Betweenness: 0<br>Closeness: 0.013<br>Eigenvector: 0.264\",\"<b>Mako<\\/b><br>Degree: 40<br>Betweenness: 197.62<br>Closeness: 0.02<br>Eigenvector: 1\",\"<b>Reef Guardian<\\/b><br>Degree: 24<br>Betweenness: 56.41<br>Closeness: 0.016<br>Eigenvector: 0.658\",\"<b>Horizon<\\/b><br>Degree: 16<br>Betweenness: 15.28<br>Closeness: 0.015<br>Eigenvector: 0.501\",\"<b>Seawatch<\\/b><br>Degree: 10<br>Betweenness: 1.24<br>Closeness: 0.012<br>Eigenvector: 0.287\",\"<b>EcoVigil<\\/b><br>Degree: 12<br>Betweenness: 5.05<br>Closeness: 0.013<br>Eigenvector: 0.369\",\"<b>Sentinel<\\/b><br>Degree: 18<br>Betweenness: 28.42<br>Closeness: 0.016<br>Eigenvector: 0.567\",\"<b>Osprey<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 0.012<br>Eigenvector: 0.116\",\"<b>Defender<\\/b><br>Degree: 6<br>Betweenness: 2.27<br>Closeness: 0.013<br>Eigenvector: 0.226\",\"<b>Northern Light<\\/b><br>Degree: 8<br>Betweenness: 8.89<br>Closeness: 0.012<br>Eigenvector: 0.197\",\"<b>Remora<\\/b><br>Degree: 22<br>Betweenness: 24.68<br>Closeness: 0.015<br>Eigenvector: 0.638\",\"<b>Knowles<\\/b><br>Degree: 4<br>Betweenness: 0<br>Closeness: 0.012<br>Eigenvector: 0.181\",\"<b>City Officials<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 0.01<br>Eigenvector: 0.071\"]},\"edges\":{\"from\":[16,7,16,18,16,5,16,26,16,14,16,8,16,13,16,15,16,21,37,23,9,10,7,36,7,26,7,3,7,23,7,35,7,8,7,17,7,21,33,26,33,27,33,29,30,20,30,28,30,5,30,19,30,27,30,31,4,5,4,26,4,3,4,23,4,21,18,34,18,35,18,6,20,28,20,26,20,34,20,19,20,27,20,29,20,31,20,12,28,26,28,19,28,27,28,29,28,31,28,12,2,1,36,26,5,3,5,19,5,15,26,24,26,14,26,23,26,19,26,32,26,27,26,35,26,22,26,6,26,31,26,25,26,17,26,21,24,3,24,19,24,27,24,35,14,23,14,35,14,8,14,11,14,15,14,21,3,23,3,19,3,35,3,8,3,22,3,31,3,21,23,27,23,35,23,25,23,21,34,19,34,22,19,27,19,6,19,31,27,29,27,31,27,25,27,12,35,8,35,22,35,17,35,21,8,22,8,21,22,6,1,12,29,31,31,12,13,15,11,12],\"to\":[7,16,18,16,5,16,26,16,14,16,8,16,13,16,15,16,21,16,23,37,10,9,36,7,26,7,3,7,23,7,35,7,8,7,17,7,21,7,26,33,27,33,29,33,20,30,28,30,5,30,19,30,27,30,31,30,5,4,26,4,3,4,23,4,21,4,34,18,35,18,6,18,28,20,26,20,34,20,19,20,27,20,29,20,31,20,12,20,26,28,19,28,27,28,29,28,31,28,12,28,1,2,26,36,3,5,19,5,15,5,24,26,14,26,23,26,19,26,32,26,27,26,35,26,22,26,6,26,31,26,25,26,17,26,21,26,3,24,19,24,27,24,35,24,23,14,35,14,8,14,11,14,15,14,21,14,23,3,19,3,35,3,8,3,22,3,31,3,21,3,27,23,35,23,25,23,21,23,19,34,22,34,27,19,6,19,31,19,29,27,31,27,25,27,12,27,8,35,22,35,17,35,21,35,22,8,21,8,6,22,12,1,31,29,12,31,15,13,12,11],\"weight\":[1,1,1,1,1,1,3,3,10,10,3,3,2,2,7,7,2,2,1,1,38,38,2,2,6,6,5,5,3,3,5,5,3,3,2,2,3,3,1,1,5,5,1,1,3,3,8,8,3,3,2,2,6,6,2,2,2,2,1,1,3,3,3,3,2,2,1,1,1,1,1,1,6,6,2,2,2,2,18,18,6,6,3,3,3,3,3,3,1,1,1,1,4,4,2,2,9,9,5,5,3,3,1,1,4,4,14,14,2,2,2,2,1,1,10,10,3,3,8,8,4,4,14,14,1,1,7,7,9,9,3,3,1,1,2,2,1,1,2,2,4,4,2,2,2,2,1,1,1,1,20,20,6,6,2,2,3,3,2,2,1,1,1,1,1,1,1,1,2,2,2,2,15,15,3,3,12,12,2,2,1,1,6,6,5,5,3,3,4,4,4,4,5,5,1,1,2,2,3,3,4,4,3,3,1,1,1,1,3,3,8,8,1,1,4,4,4,4,20,20],\"arrows\":[\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\"],\"color\":[\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"font\":{\"size\":16}},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"interaction\":{\"hover\":true,\"zoomSpeed\":1},\"layout\":{\"randomSeed\":42}},\"groups\":[\"Person\",\"Organization\",\"Vessel\",\"Group\"],\"width\":null,\"height\":null,\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"highlight\":{\"enabled\":true,\"hoverNearest\":true,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":false,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"Person\",\"Vessel\",\"Organization\",\"Group\"],\"shape\":[\"dot\",\"triangle\",\"box\",\"star\"],\"color\":[\"orange\",\"forestgreen\",\"pink\",\"blue\"]},\"nodesToDataframe\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Step 1: Convert to igraph\ng_igraph <- igraph::graph_from_data_frame(\n  d = vis_edges %>% select(from, to),\n  vertices = vis_nodes %>% select(id, label),\n  directed = FALSE\n)\n\n# Step 2: Apply clustering\nclustering_method <- \"label_prop\"  # options: \"louvain\", \"label_prop\"\n\nclusters <- switch(\n  clustering_method,\n  louvain     = cluster_louvain(g_igraph),\n  label_prop  = cluster_label_prop(g_igraph),\n  stop(\"Unsupported clustering method\")\n)\n\nmembership_df <- data.frame(\n  id = names(membership(clusters)),\n  cluster_id = membership(clusters),\n  stringsAsFactors = FALSE\n)\n\n# Step 3: Merge with vis_nodes and color by cluster\nn_clusters <- length(unique(membership_df$cluster_id))\npalette <- RColorBrewer::brewer.pal(max(3, min(8, n_clusters)), \"Set2\")\n\nvis_nodes_clustered <- vis_nodes %>%\n  mutate(id = as.character(id)) %>%\n  left_join(membership_df, by = \"id\") %>%\n  mutate(\n    group = paste0(\"Cluster \", cluster_id),\n    color = palette[as.numeric(factor(cluster_id))]\n  )\n\n# Optional legend\nlegend_data <- vis_nodes_clustered %>%\n  distinct(group, color) %>%\n  mutate(label = group, shape = \"dot\") %>%\n  select(label, shape, color)\n\n# Step 4: Visualize with clustering\nvisNetwork(vis_nodes_clustered, vis_edges) %>%\n  visNodes(font = list(size = 16)) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(\n    highlightNearest = list(enabled = TRUE, degree = 1, hover = TRUE),\n    nodesIdSelection = TRUE\n  ) %>%\n  visLegend(\n    addNodes = legend_data,\n    useGroups = FALSE,\n    position = \"right\"\n  ) %>%\n  visLayout(randomSeed = 42)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-40f92511009264e0ecec\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-40f92511009264e0ecec\">{\"x\":{\"nodes\":{\"id\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\"],\"group\":[\"Cluster 1\",\"Cluster 1\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 3\",\"Cluster 3\",\"Cluster 2\",\"Cluster 1\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 1\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 1\",\"Cluster 1\",\"Cluster 1\",\"Cluster 1\",\"Cluster 1\",\"Cluster 2\",\"Cluster 1\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\",\"Cluster 2\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"box\",\"box\",\"box\",\"box\",\"box\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"star\"],\"color\":[\"#66C2A5\",\"#66C2A5\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#8DA0CB\",\"#8DA0CB\",\"#FC8D62\",\"#66C2A5\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#66C2A5\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#66C2A5\",\"#66C2A5\",\"#66C2A5\",\"#66C2A5\",\"#66C2A5\",\"#FC8D62\",\"#66C2A5\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\"],\"value\":[6.052631578947368,5,15.52631578947368,9.210526315789473,10.26315789473684,8.157894736842106,13.42105263157895,11.31578947368421,5,5,6.052631578947368,10.26315789473684,6.052631578947368,12.36842105263158,8.157894736842106,13.42105263157895,7.105263157894736,8.157894736842106,15.52631578947368,13.42105263157895,13.42105263157895,10.26315789473684,14.47368421052632,9.210526315789473,7.105263157894736,25,16.57894736842105,12.36842105263158,9.210526315789473,10.26315789473684,13.42105263157895,5,7.105263157894736,8.157894736842106,15.52631578947368,6.052631578947368,5],\"title\":[\"<b>Sam<\\/b><br>Degree: 4<br>Betweenness: 33<br>Closeness: 0.009<br>Eigenvector: 0.032\",\"<b>Kelly<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 0.007<br>Eigenvector: 0.004\",\"<b>Nadia Conti<\\/b><br>Degree: 22<br>Betweenness: 30.16<br>Closeness: 0.016<br>Eigenvector: 0.635\",\"<b>Elise<\\/b><br>Degree: 10<br>Betweenness: 3.24<br>Closeness: 0.014<br>Eigenvector: 0.365\",\"<b>Liam Thorne<\\/b><br>Degree: 12<br>Betweenness: 16.03<br>Closeness: 0.013<br>Eigenvector: 0.3\",\"<b>Samantha Blake<\\/b><br>Degree: 8<br>Betweenness: 3.87<br>Closeness: 0.013<br>Eigenvector: 0.253\",\"<b>Davis<\\/b><br>Degree: 18<br>Betweenness: 13.62<br>Closeness: 0.014<br>Eigenvector: 0.555\",\"<b>Rodriguez<\\/b><br>Degree: 14<br>Betweenness: 4.41<br>Closeness: 0.013<br>Eigenvector: 0.428\",\"<b>Clepper Jensen<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 1<br>Eigenvector: 0\",\"<b>Miranda Jordan<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 1<br>Eigenvector: 0\",\"<b>The Intern<\\/b><br>Degree: 4<br>Betweenness: 9.9<br>Closeness: 0.012<br>Eigenvector: 0.085\",\"<b>The Lookout<\\/b><br>Degree: 12<br>Betweenness: 73.17<br>Closeness: 0.013<br>Eigenvector: 0.275\",\"<b>The Accountant<\\/b><br>Degree: 4<br>Betweenness: 0<br>Closeness: 0.01<br>Eigenvector: 0.067\",\"<b>Mrs. Money<\\/b><br>Degree: 16<br>Betweenness: 40.49<br>Closeness: 0.015<br>Eigenvector: 0.457\",\"<b>The Middleman<\\/b><br>Degree: 8<br>Betweenness: 4.95<br>Closeness: 0.012<br>Eigenvector: 0.146\",\"<b>Boss<\\/b><br>Degree: 18<br>Betweenness: 49.3<br>Closeness: 0.015<br>Eigenvector: 0.433\",\"<b>Small Fry<\\/b><br>Degree: 6<br>Betweenness: 0<br>Closeness: 0.013<br>Eigenvector: 0.255\",\"<b>Glitters Team<\\/b><br>Degree: 8<br>Betweenness: 6.38<br>Closeness: 0.012<br>Eigenvector: 0.177\",\"<b>Oceanus City Council<\\/b><br>Degree: 22<br>Betweenness: 30.58<br>Closeness: 0.016<br>Eigenvector: 0.629\",\"<b>Green Guardians<\\/b><br>Degree: 18<br>Betweenness: 30.77<br>Closeness: 0.016<br>Eigenvector: 0.521\",\"<b>V. Miesel Shipping<\\/b><br>Degree: 18<br>Betweenness: 6.69<br>Closeness: 0.015<br>Eigenvector: 0.595\",\"<b>Sailor Shifts Team<\\/b><br>Degree: 12<br>Betweenness: 9.55<br>Closeness: 0.014<br>Eigenvector: 0.366\",\"<b>Neptune<\\/b><br>Degree: 20<br>Betweenness: 46.82<br>Closeness: 0.016<br>Eigenvector: 0.609\",\"<b>Marlin<\\/b><br>Degree: 10<br>Betweenness: 2.22<br>Closeness: 0.014<br>Eigenvector: 0.414\",\"<b>Serenity<\\/b><br>Degree: 6<br>Betweenness: 0<br>Closeness: 0.013<br>Eigenvector: 0.264\",\"<b>Mako<\\/b><br>Degree: 40<br>Betweenness: 197.62<br>Closeness: 0.02<br>Eigenvector: 1\",\"<b>Reef Guardian<\\/b><br>Degree: 24<br>Betweenness: 56.41<br>Closeness: 0.016<br>Eigenvector: 0.658\",\"<b>Horizon<\\/b><br>Degree: 16<br>Betweenness: 15.28<br>Closeness: 0.015<br>Eigenvector: 0.501\",\"<b>Seawatch<\\/b><br>Degree: 10<br>Betweenness: 1.24<br>Closeness: 0.012<br>Eigenvector: 0.287\",\"<b>EcoVigil<\\/b><br>Degree: 12<br>Betweenness: 5.05<br>Closeness: 0.013<br>Eigenvector: 0.369\",\"<b>Sentinel<\\/b><br>Degree: 18<br>Betweenness: 28.42<br>Closeness: 0.016<br>Eigenvector: 0.567\",\"<b>Osprey<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 0.012<br>Eigenvector: 0.116\",\"<b>Defender<\\/b><br>Degree: 6<br>Betweenness: 2.27<br>Closeness: 0.013<br>Eigenvector: 0.226\",\"<b>Northern Light<\\/b><br>Degree: 8<br>Betweenness: 8.89<br>Closeness: 0.012<br>Eigenvector: 0.197\",\"<b>Remora<\\/b><br>Degree: 22<br>Betweenness: 24.68<br>Closeness: 0.015<br>Eigenvector: 0.638\",\"<b>Knowles<\\/b><br>Degree: 4<br>Betweenness: 0<br>Closeness: 0.012<br>Eigenvector: 0.181\",\"<b>City Officials<\\/b><br>Degree: 2<br>Betweenness: 0<br>Closeness: 0.01<br>Eigenvector: 0.071\"],\"cluster_id\":[1,1,2,2,2,2,2,2,3,3,2,1,2,2,2,2,2,2,2,1,2,2,2,2,2,2,1,1,1,1,1,2,1,2,2,2,2]},\"edges\":{\"from\":[16,7,16,18,16,5,16,26,16,14,16,8,16,13,16,15,16,21,37,23,9,10,7,36,7,26,7,3,7,23,7,35,7,8,7,17,7,21,33,26,33,27,33,29,30,20,30,28,30,5,30,19,30,27,30,31,4,5,4,26,4,3,4,23,4,21,18,34,18,35,18,6,20,28,20,26,20,34,20,19,20,27,20,29,20,31,20,12,28,26,28,19,28,27,28,29,28,31,28,12,2,1,36,26,5,3,5,19,5,15,26,24,26,14,26,23,26,19,26,32,26,27,26,35,26,22,26,6,26,31,26,25,26,17,26,21,24,3,24,19,24,27,24,35,14,23,14,35,14,8,14,11,14,15,14,21,3,23,3,19,3,35,3,8,3,22,3,31,3,21,23,27,23,35,23,25,23,21,34,19,34,22,19,27,19,6,19,31,27,29,27,31,27,25,27,12,35,8,35,22,35,17,35,21,8,22,8,21,22,6,1,12,29,31,31,12,13,15,11,12],\"to\":[7,16,18,16,5,16,26,16,14,16,8,16,13,16,15,16,21,16,23,37,10,9,36,7,26,7,3,7,23,7,35,7,8,7,17,7,21,7,26,33,27,33,29,33,20,30,28,30,5,30,19,30,27,30,31,30,5,4,26,4,3,4,23,4,21,4,34,18,35,18,6,18,28,20,26,20,34,20,19,20,27,20,29,20,31,20,12,20,26,28,19,28,27,28,29,28,31,28,12,28,1,2,26,36,3,5,19,5,15,5,24,26,14,26,23,26,19,26,32,26,27,26,35,26,22,26,6,26,31,26,25,26,17,26,21,26,3,24,19,24,27,24,35,24,23,14,35,14,8,14,11,14,15,14,21,14,23,3,19,3,35,3,8,3,22,3,31,3,21,3,27,23,35,23,25,23,21,23,19,34,22,34,27,19,6,19,31,19,29,27,31,27,25,27,12,27,8,35,22,35,17,35,21,35,22,8,21,8,6,22,12,1,31,29,12,31,15,13,12,11],\"weight\":[1,1,1,1,1,1,3,3,10,10,3,3,2,2,7,7,2,2,1,1,38,38,2,2,6,6,5,5,3,3,5,5,3,3,2,2,3,3,1,1,5,5,1,1,3,3,8,8,3,3,2,2,6,6,2,2,2,2,1,1,3,3,3,3,2,2,1,1,1,1,1,1,6,6,2,2,2,2,18,18,6,6,3,3,3,3,3,3,1,1,1,1,4,4,2,2,9,9,5,5,3,3,1,1,4,4,14,14,2,2,2,2,1,1,10,10,3,3,8,8,4,4,14,14,1,1,7,7,9,9,3,3,1,1,2,2,1,1,2,2,4,4,2,2,2,2,1,1,1,1,20,20,6,6,2,2,3,3,2,2,1,1,1,1,1,1,1,1,2,2,2,2,15,15,3,3,12,12,2,2,1,1,6,6,5,5,3,3,4,4,4,4,5,5,1,1,2,2,3,3,4,4,3,3,1,1,1,1,3,3,8,8,1,1,4,4,4,4,20,20],\"arrows\":[\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\",\"none\"],\"color\":[\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\",\"gray\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"font\":{\"size\":16}},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"interaction\":{\"hover\":true,\"zoomSpeed\":1},\"layout\":{\"randomSeed\":42}},\"groups\":[\"Cluster 1\",\"Cluster 2\",\"Cluster 3\"],\"width\":null,\"height\":null,\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"highlight\":{\"enabled\":true,\"hoverNearest\":true,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":false,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"Cluster 1\",\"Cluster 2\",\"Cluster 3\"],\"shape\":[\"dot\",\"dot\",\"dot\"],\"color\":[\"#66C2A5\",\"#FC8D62\",\"#8DA0CB\"]},\"nodesToDataframe\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add cluster membership from igraph back into tbl_graph\ncluster_membership <- membership(clusters)\n\nsummary_tbl <- full_graph %>%\n  mutate(cluster = cluster_membership) %>%\n  as_tibble() %>%\n  select(\n    name,\n    sub_type,\n    cluster,\n    degree,\n    betweenness,\n    closeness,\n    eigen\n  ) %>%\n  arrange(cluster, desc(degree)) %>%\n  mutate(across(where(is.numeric), ~ round(.x, 3)))  # Round numeric values\n\nprint(summary_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 37 × 7\n   name            sub_type     cluster    degree betweenness closeness eigen\n   <chr>           <chr>        <membrshp>  <dbl>       <dbl>     <dbl> <dbl>\n 1 Reef Guardian   Vessel       1              24       56.4      0.016 0.658\n 2 Green Guardians Organization 1              18       30.8      0.016 0.521\n 3 Sentinel        Vessel       1              18       28.4      0.016 0.567\n 4 Horizon         Vessel       1              16       15.3      0.015 0.501\n 5 The Lookout     Person       1              12       73.2      0.013 0.275\n 6 EcoVigil        Vessel       1              12        5.05     0.013 0.369\n 7 Seawatch        Vessel       1              10        1.24     0.012 0.287\n 8 Defender        Vessel       1               6        2.27     0.013 0.226\n 9 Sam             Person       1               4       33        0.009 0.032\n10 Kelly           Person       1               2        0        0.007 0.004\n# ℹ 27 more rows\n```\n\n\n:::\n:::\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\n<script src=\"../../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\n<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}